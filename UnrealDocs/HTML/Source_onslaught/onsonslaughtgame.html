<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>UT2004 UnrealScript - Source: Onslaught.ONSOnslaughtGame</title>
	<meta name="Generator" content="UnCodeX 241" />
	<link rel="stylesheet" href="../DocStyle2.css" type="text/css" title="Original Purple" />
	<link rel="alternative stylesheet" href="../DocStyle2-blue.css" type="text/css" title="Blue" />
	<link rel="alternative stylesheet" href="../DocStyle2-red.css" type="text/css" title="Red" />
	<!--[if IE]>
	<link rel="stylesheet" href="../DocStyle2-msie.css" type="text/css" />
	<![endif]-->
	<script src="../styleswitcher.js" type="text/javascript"></script>
</head>
<body>

<div class="header">
<table class="header">
<tr class="header">
	<td class="header"><a href="../overview.html">Overview</a></td>
	<td class="header"><a href="../onslaught/onslaught-overview.html">Package</a></td>
	<td class="header"><a href="../onslaught/onsonslaughtgame.html">Class</a></td>
	<td class="header_hilight">Source</td>
	<td class="header"><a class="header" href="../classtree.html#ONSOnslaughtGame">Class tree</a></td>
	<td class="header"><a class="header" href="../glossary_A.html">Glossary</a></td>
	<td class="logo" rowspan="2">UnrealScript<br />Documentation</td>
</tr>
<tr>
	<td class="subheader" colspan="3"><a href="../Source_onslaught/onsnodehealeffect.html">previous class</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../Source_onslaught/onsonslaughtmessage.html">next class</a></td>
	<td class="subheader" colspan="2"><a href="../index.html#Source_onslaught/onsonslaughtgame.html" target="_top">frames</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="" target="_top">no frames</a></td>
</tr>
</table>
</div>
<div class="spacer"></div>

<h1><a href="../onslaught/onslaught-overview.html">Onslaught</a>.<a href="../onslaught/onsonslaughtgame.html">ONSOnslaughtGame</a></h1>
<br />
<div class="source"><table class="source"><tr><td class="source_lineno"><span class="source_lineno">00001<br />00002<br />00003<br />00004<br />00005<br />00006<br />00007<br />00008<br />00009<br />00010<br />00011<br />00012<br />00013<br />00014<br />00015<br />00016<br />00017<br />00018<br />00019<br />00020<br />
00021<br />00022<br />00023<br />00024<br />00025<br />00026<br />00027<br />00028<br />00029<br />00030<br />00031<br />00032<br />00033<br />00034<br />00035<br />00036<br />00037<br />00038<br />00039<br />00040<br />
00041<br />00042<br />00043<br />00044<br />00045<br />00046<br />00047<br />00048<br />00049<br />00050<br />00051<br />00052<br />00053<br />00054<br />00055<br />00056<br />00057<br />00058<br />00059<br />00060<br />
00061<br />00062<br />00063<br />00064<br />00065<br />00066<br />00067<br />00068<br />00069<br />00070<br />00071<br />00072<br />00073<br />00074<br />00075<br />00076<br />00077<br />00078<br />00079<br />00080<br />
00081<br />00082<br />00083<br />00084<br />00085<br />00086<br />00087<br />00088<br />00089<br />00090<br />00091<br />00092<br />00093<br />00094<br />00095<br />00096<br />00097<br />00098<br />00099<br />00100<br />
00101<br />00102<br />00103<br />00104<br />00105<br />00106<br />00107<br />00108<br />00109<br />00110<br />00111<br />00112<br />00113<br />00114<br />00115<br />00116<br />00117<br />00118<br />00119<br />00120<br />
00121<br />00122<br />00123<br />00124<br />00125<br />00126<br />00127<br />00128<br />00129<br />00130<br />00131<br />00132<br />00133<br />00134<br />00135<br />00136<br />00137<br />00138<br />00139<br />00140<br />
00141<br />00142<br />00143<br />00144<br />00145<br />00146<br />00147<br />00148<br />00149<br />00150<br />00151<br />00152<br />00153<br />00154<br />00155<br />00156<br />00157<br />00158<br />00159<br />00160<br />
00161<br />00162<br />00163<br />00164<br />00165<br />00166<br />00167<br />00168<br />00169<br />00170<br />00171<br />00172<br />00173<br />00174<br />00175<br />00176<br />00177<br />00178<br />00179<br />00180<br />
00181<br />00182<br />00183<br />00184<br />00185<br />00186<br />00187<br />00188<br />00189<br />00190<br />00191<br />00192<br />00193<br />00194<br />00195<br />00196<br />00197<br />00198<br />00199<br />00200<br />
00201<br />00202<br />00203<br />00204<br />00205<br />00206<br />00207<br />00208<br />00209<br />00210<br />00211<br />00212<br />00213<br />00214<br />00215<br />00216<br />00217<br />00218<br />00219<br />00220<br />
00221<br />00222<br />00223<br />00224<br />00225<br />00226<br />00227<br />00228<br />00229<br />00230<br />00231<br />00232<br />00233<br />00234<br />00235<br />00236<br />00237<br />00238<br />00239<br />00240<br />
00241<br />00242<br />00243<br />00244<br />00245<br />00246<br />00247<br />00248<br />00249<br />00250<br />00251<br />00252<br />00253<br />00254<br />00255<br />00256<br />00257<br />00258<br />00259<br />00260<br />
00261<br />00262<br />00263<br />00264<br />00265<br />00266<br />00267<br />00268<br />00269<br />00270<br />00271<br />00272<br />00273<br />00274<br />00275<br />00276<br />00277<br />00278<br />00279<br />00280<br />
00281<br />00282<br />00283<br />00284<br />00285<br />00286<br />00287<br />00288<br />00289<br />00290<br />00291<br />00292<br />00293<br />00294<br />00295<br />00296<br />00297<br />00298<br />00299<br />00300<br />
00301<br />00302<br />00303<br />00304<br />00305<br />00306<br />00307<br />00308<br />00309<br />00310<br />00311<br />00312<br />00313<br />00314<br />00315<br />00316<br />00317<br />00318<br />00319<br />00320<br />
00321<br />00322<br />00323<br />00324<br />00325<br />00326<br />00327<br />00328<br />00329<br />00330<br />00331<br />00332<br />00333<br />00334<br />00335<br />00336<br />00337<br />00338<br />00339<br />00340<br />
00341<br />00342<br />00343<br />00344<br />00345<br />00346<br />00347<br />00348<br />00349<br />00350<br />00351<br />00352<br />00353<br />00354<br />00355<br />00356<br />00357<br />00358<br />00359<br />00360<br />
00361<br />00362<br />00363<br />00364<br />00365<br />00366<br />00367<br />00368<br />00369<br />00370<br />00371<br />00372<br />00373<br />00374<br />00375<br />00376<br />00377<br />00378<br />00379<br />00380<br />
00381<br />00382<br />00383<br />00384<br />00385<br />00386<br />00387<br />00388<br />00389<br />00390<br />00391<br />00392<br />00393<br />00394<br />00395<br />00396<br />00397<br />00398<br />00399<br />00400<br />
00401<br />00402<br />00403<br />00404<br />00405<br />00406<br />00407<br />00408<br />00409<br />00410<br />00411<br />00412<br />00413<br />00414<br />00415<br />00416<br />00417<br />00418<br />00419<br />00420<br />
00421<br />00422<br />00423<br />00424<br />00425<br />00426<br />00427<br />00428<br />00429<br />00430<br />00431<br />00432<br />00433<br />00434<br />00435<br />00436<br />00437<br />00438<br />00439<br />00440<br />
00441<br />00442<br />00443<br />00444<br />00445<br />00446<br />00447<br />00448<br />00449<br />00450<br />00451<br />00452<br />00453<br />00454<br />00455<br />00456<br />00457<br />00458<br />00459<br />00460<br />
00461<br />00462<br />00463<br />00464<br />00465<br />00466<br />00467<br />00468<br />00469<br />00470<br />00471<br />00472<br />00473<br />00474<br />00475<br />00476<br />00477<br />00478<br />00479<br />00480<br />
00481<br />00482<br />00483<br />00484<br />00485<br />00486<br />00487<br />00488<br />00489<br />00490<br />00491<br />00492<br />00493<br />00494<br />00495<br />00496<br />00497<br />00498<br />00499<br />00500<br />
00501<br />00502<br />00503<br />00504<br />00505<br />00506<br />00507<br />00508<br />00509<br />00510<br />00511<br />00512<br />00513<br />00514<br />00515<br />00516<br />00517<br />00518<br />00519<br />00520<br />
00521<br />00522<br />00523<br />00524<br />00525<br />00526<br />00527<br />00528<br />00529<br />00530<br />00531<br />00532<br />00533<br />00534<br />00535<br />00536<br />00537<br />00538<br />00539<br />00540<br />
00541<br />00542<br />00543<br />00544<br />00545<br />00546<br />00547<br />00548<br />00549<br />00550<br />00551<br />00552<br />00553<br />00554<br />00555<br />00556<br />00557<br />00558<br />00559<br />00560<br />
00561<br />00562<br />00563<br />00564<br />00565<br />00566<br />00567<br />00568<br />00569<br />00570<br />00571<br />00572<br />00573<br />00574<br />00575<br />00576<br />00577<br />00578<br />00579<br />00580<br />
00581<br />00582<br />00583<br />00584<br />00585<br />00586<br />00587<br />00588<br />00589<br />00590<br />00591<br />00592<br />00593<br />00594<br />00595<br />00596<br />00597<br />00598<br />00599<br />00600<br />
00601<br />00602<br />00603<br />00604<br />00605<br />00606<br />00607<br />00608<br />00609<br />00610<br />00611<br />00612<br />00613<br />00614<br />00615<br />00616<br />00617<br />00618<br />00619<br />00620<br />
00621<br />00622<br />00623<br />00624<br />00625<br />00626<br />00627<br />00628<br />00629<br />00630<br />00631<br />00632<br />00633<br />00634<br />00635<br />00636<br />00637<br />00638<br />00639<br />00640<br />
00641<br />00642<br />00643<br />00644<br />00645<br />00646<br />00647<br />00648<br />00649<br />00650<br />00651<br />00652<br />00653<br />00654<br />00655<br />00656<br />00657<br />00658<br />00659<br />00660<br />
00661<br />00662<br />00663<br />00664<br />00665<br />00666<br />00667<br />00668<br />00669<br />00670<br />00671<br />00672<br />00673<br />00674<br />00675<br />00676<br />00677<br />00678<br />00679<br />00680<br />
00681<br />00682<br />00683<br />00684<br />00685<br />00686<br />00687<br />00688<br />00689<br />00690<br />00691<br />00692<br />00693<br />00694<br />00695<br />00696<br />00697<br />00698<br />00699<br />00700<br />
00701<br />00702<br />00703<br />00704<br />00705<br />00706<br />00707<br />00708<br />00709<br />00710<br />00711<br />00712<br />00713<br />00714<br />00715<br />00716<br />00717<br />00718<br />00719<br />00720<br />
00721<br />00722<br />00723<br />00724<br />00725<br />00726<br />00727<br />00728<br />00729<br />00730<br />00731<br />00732<br />00733<br />00734<br />00735<br />00736<br />00737<br />00738<br />00739<br />00740<br />
00741<br />00742<br />00743<br />00744<br />00745<br />00746<br />00747<br />00748<br />00749<br />00750<br />00751<br />00752<br />00753<br />00754<br />00755<br />00756<br />00757<br />00758<br />00759<br />00760<br />
00761<br />00762<br />00763<br />00764<br />00765<br />00766<br />00767<br />00768<br />00769<br />00770<br />00771<br />00772<br />00773<br />00774<br />00775<br />00776<br />00777<br />00778<br />00779<br />00780<br />
00781<br />00782<br />00783<br />00784<br />00785<br />00786<br />00787<br />00788<br />00789<br />00790<br />00791<br />00792<br />00793<br />00794<br />00795<br />00796<br />00797<br />00798<br />00799<br />00800<br />
00801<br />00802<br />00803<br />00804<br />00805<br />00806<br />00807<br />00808<br />00809<br />00810<br />00811<br />00812<br />00813<br />00814<br />00815<br />00816<br />00817<br />00818<br />00819<br />00820<br />
00821<br />00822<br />00823<br />00824<br />00825<br />00826<br />00827<br />00828<br />00829<br />00830<br />00831<br />00832<br />00833<br />00834<br />00835<br />00836<br />00837<br />00838<br />00839<br />00840<br />
00841<br />00842<br />00843<br />00844<br />00845<br />00846<br />00847<br />00848<br />00849<br />00850<br />00851<br />00852<br />00853<br />00854<br />00855<br />00856<br />00857<br />00858<br />00859<br />00860<br />
00861<br />00862<br />00863<br />00864<br />00865<br />00866<br />00867<br />00868<br />00869<br />00870<br />00871<br />00872<br />00873<br />00874<br />00875<br />00876<br />00877<br />00878<br />00879<br />00880<br />
00881<br />00882<br />00883<br />00884<br />00885<br />00886<br />00887<br />00888<br />00889<br />00890<br />00891<br />00892<br />00893<br />00894<br />00895<br />00896<br />00897<br />00898<br />00899<br />00900<br />
00901<br />00902<br />00903<br />00904<br />00905<br />00906<br />00907<br />00908<br />00909<br />00910<br />00911<br />00912<br />00913<br />00914<br />00915<br />00916<br />00917<br />00918<br />00919<br />00920<br />
00921<br />00922<br />00923<br />00924<br />00925<br />00926<br />00927<br />00928<br />00929<br />00930<br />00931<br />00932<br />00933<br />00934<br />00935<br />00936<br />00937<br />00938<br />00939<br />00940<br />
00941<br />00942<br />00943<br />00944<br />00945<br />00946<br />00947<br />00948<br />00949<br />00950<br />00951<br />00952<br />00953<br />00954<br />00955<br />00956<br />00957<br />00958<br />00959<br />00960<br />
00961<br />00962<br />00963<br />00964<br />00965<br />00966<br />00967<br />00968<br />00969<br />00970<br />00971<br />00972<br />00973<br />00974<br />00975<br />00976<br />00977<br />00978<br />00979<br />00980<br />
00981<br />00982<br />00983<br />00984<br />00985<br />00986<br />00987<br />00988<br />00989<br />00990<br />00991<br />00992<br />00993<br />00994<br />00995<br />00996<br />00997<br />00998<br />00999<br />01000<br />
01001<br />01002<br />01003<br />01004<br />01005<br />01006<br />01007<br />01008<br />01009<br />01010<br />01011<br />01012<br />01013<br />01014<br />01015<br />01016<br />01017<br />01018<br />01019<br />01020<br />
01021<br />01022<br />01023<br />01024<br />01025<br />01026<br />01027<br />01028<br />01029<br />01030<br />01031<br />01032<br />01033<br />01034<br />01035<br />01036<br />01037<br />01038<br />01039<br />01040<br />
01041<br />01042<br />01043<br />01044<br />01045<br />01046<br />01047<br />01048<br />01049<br />01050<br />01051<br />01052<br />01053<br />01054<br />01055<br />01056<br />01057<br />01058<br />01059<br />01060<br />
01061<br />01062<br />01063<br />01064<br />01065<br />01066<br />01067<br />01068<br />01069<br />01070<br />01071<br />01072<br />01073<br />01074<br />01075<br />01076<br />01077<br />01078<br />01079<br />01080<br />
01081<br />01082<br />01083<br />01084<br />01085<br />01086<br />01087<br />01088<br />01089<br />01090<br />01091<br />01092<br />01093<br />01094<br />01095<br />01096<br />01097<br />01098<br />01099<br />01100<br />
01101<br />01102<br />01103<br />01104<br />01105<br />01106<br />01107<br />01108<br />01109<br />01110<br />01111<br />01112<br />01113<br />01114<br />01115<br />01116<br />01117<br />01118<br />01119<br />01120<br />
01121<br />01122<br />01123<br />01124<br />01125<br />01126<br />01127<br />01128<br />01129<br />01130<br />01131<br />01132<br />01133<br />01134<br />01135<br />01136<br />01137<br />01138<br />01139<br />01140<br />
01141<br />01142<br />01143<br />01144<br />01145<br />01146<br />01147<br />01148<br />01149<br />01150<br />01151<br />01152<br />01153<br />01154<br />01155<br />01156<br />01157<br />01158<br />01159<br />01160<br />
01161<br />01162<br />01163<br />01164<br />01165<br />01166<br />01167<br />01168<br />01169<br />01170<br />01171<br />01172<br />01173<br />01174<br />01175<br />01176<br />01177<br />01178<br />01179<br />01180<br />
01181<br />01182<br />01183<br />01184<br />01185<br />01186<br />01187<br />01188<br />01189<br />01190<br />01191<br />01192<br />01193<br />01194<br />01195<br />01196<br />01197<br />01198<br />01199<br />01200<br />
01201<br />01202<br />01203<br />01204<br />01205<br />01206<br />01207<br />01208<br />01209<br />01210<br />01211<br />01212<br />01213<br />01214<br />01215<br />01216<br />01217<br />01218<br />01219<br />01220<br />
01221<br />01222<br />01223<br />01224<br />01225<br />01226<br />01227<br />01228<br />01229<br />01230<br />01231<br />01232<br />01233<br />01234<br />01235<br />01236<br />01237<br />01238<br />01239<br />01240<br />
01241<br />01242<br />01243<br />01244<br />01245<br />01246<br />01247<br />01248<br />01249<br />01250<br />01251<br />01252<br />01253<br />01254<br />01255<br />01256<br />01257<br />01258<br />01259<br />01260<br />
01261<br />01262<br />01263<br />01264<br />01265<br />01266<br />01267<br />01268<br />01269<br />01270<br />01271<br />01272<br />01273<br />01274<br />01275<br />01276<br />01277<br />01278<br />01279<br />01280<br />
01281<br />01282<br />01283<br />01284<br />01285<br />01286<br />01287</span></td>
<td class="source"><pre class="source"><a name="1"></a><span class="source_comment">//-----------------------------------------------------------
</span><a name="2"></a><span class="source_comment">//
</span><a name="3"></a><span class="source_comment">//-----------------------------------------------------------
</span><a name="4"></a>
<a name="5"></a><span class="source_keyword">class</span> <span class="source_type"><a href="../onslaught/onsonslaughtgame.html" class="source">ONSOnslaughtGame</a></span> <span class="source_keyword">extends</span> <span class="source_type"><a href="../xgame/xteamgame.html" class="source">xTeamGame</a></span>;
<a name="6"></a>
<a name="7"></a><span class="source_keyword">var</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>&gt;         PowerCores;
<a name="8"></a><span class="source_keyword">var</span> <span class="source_keyword">int</span>                         FinalCore[<span class="source_int">2</span>];
<a name="9"></a>
<a name="10"></a><span class="source_comment">// GameUMenuType - This menu is displayed to players when they die - it should contain the map for choosing where to respawn at
</span><a name="11"></a>
<a name="12"></a><span class="source_keyword">struct</span> <span class="source_type"><a href="../onslaught/onsonslaughtgame.html#PowerLinkSetup" class="source">PowerLinkSetup</a></span>
<a name="13"></a>{
<a name="14"></a>	<span class="source_keyword">var</span> <span class="source_keyword">name</span> BaseNode;
<a name="15"></a>	<span class="source_keyword">var</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">name</span>&gt; LinkedNodes;
<a name="16"></a>};
<a name="17"></a>
<a name="18"></a><span class="source_keyword">var</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowerlinkofficialsetup.html" class="source">ONSPowerLinkOfficialSetup</a></span>&gt; OfficialPowerLinkSetups;
<a name="19"></a><span class="source_keyword">var</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowerlinkcustomsetup.html" class="source">ONSPowerLinkCustomSetup</a></span>&gt; CustomPowerLinkSetups;
<a name="20"></a><span class="source_keyword">var</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/powerlink.html" class="source">PowerLink</a></span>&gt; PowerLinks;
<a name="21"></a>
<a name="22"></a><span class="source_keyword">var</span> <span class="source_keyword2">config</span> <span class="source_keyword">int</span> OvertimeCoreDrainPerSec;
<a name="23"></a><span class="source_keyword">var</span> <span class="source_keyword2">config</span> <span class="source_keyword">bool</span> bRandSetupAfterReset;	<span class="source_comment">//choose a random link setup to play after a reset
</span><a name="24"></a><span class="source_keyword">var</span> <span class="source_keyword2">config</span> <span class="source_keyword">bool</span> bSwapSidesAfterReset;
<a name="25"></a><span class="source_keyword">var</span> <span class="source_keyword">bool</span>        bSidesAreSwitched;
<a name="26"></a>
<a name="27"></a><span class="source_keyword">var</span> <span class="source_keyword">bool</span> bCurrentSetupIsOfficial;
<a name="28"></a><span class="source_keyword">var</span> <span class="source_keyword">string</span> CurrentSetupName;
<a name="29"></a>
<a name="30"></a><span class="source_comment">// localized PlayInfo descriptions & extra info
</span><a name="31"></a><span class="source_keyword">const</span> ONSPROPNUM = <span class="source_int">3</span>;
<a name="32"></a><span class="source_keyword">var</span> <span class="source_keyword2">localized</span> <span class="source_keyword">string</span> ONSPropsDisplayText[ONSPROPNUM];
<a name="33"></a><span class="source_keyword">var</span> <span class="source_keyword2">localized</span> <span class="source_keyword">string</span> ONSPropDescText[ONSPROPNUM];
<a name="34"></a>
<a name="35"></a><span class="source_keyword">var</span>(LoadingHints) <span class="source_keyword2">private</span> <span class="source_keyword2">localized</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">string</span>&gt; ONSHints;
<a name="36"></a>
<a name="37"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> AllowTransloc()
<a name="38"></a>{
<a name="39"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="40"></a>}
<a name="41"></a>
<a name="42"></a><span class="source_keyword2">static</span> <span class="source_keyword">function</span> <span class="source_keyword">bool</span> NeverAllowTransloc()
<a name="43"></a>{
<a name="44"></a>	<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="45"></a>}
<a name="46"></a>
<a name="47"></a><span class="source_keyword2">static</span> <span class="source_keyword">function</span> <span class="source_keyword">bool</span> AllowMutator( <span class="source_keyword">string</span> <span class="source_type">MutatorClassName</span> )
<a name="48"></a>{
<a name="49"></a>	<span class="source_keyword">if</span> ( <span class="source_type">MutatorClassName</span> == <span class="source_string">""</span> )
<a name="50"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="51"></a>
<a name="52"></a>	<span class="source_keyword">if</span> ( <span class="source_type">MutatorClassName</span> ~= <span class="source_string">"xGame.MutInstagib"</span> )
<a name="53"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="54"></a>	<span class="source_keyword">if</span> ( <span class="source_type">MutatorClassName</span> ~= <span class="source_string">"xGame.MutZoomInstagib"</span> )
<a name="55"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="56"></a>
<a name="57"></a>	<span class="source_keyword">return</span> <span class="source_keyword">super</span>.AllowMutator(<span class="source_type">MutatorClassName</span>);
<a name="58"></a>}
<a name="59"></a>
<a name="60"></a><span class="source_keyword">event</span> SetGrammar()
<a name="61"></a>{
<a name="62"></a>	LoadSRGrammar(<span class="source_string">"ONS"</span>);
<a name="63"></a>}
<a name="64"></a>
<a name="65"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> ApplyOrder( <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">Sender</span>, <span class="source_keyword">int</span> RecipientID, <span class="source_keyword">int</span> <span class="source_type">OrderID</span> )
<a name="66"></a>{
<a name="67"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../engine/controller.html" class="source">controller</a></span> <span class="source_type">P</span>;
<a name="68"></a>
<a name="69"></a>	<span class="source_keyword">if</span> ( <span class="source_type">OrderID</span> == <span class="source_int">299</span> )
<a name="70"></a>	{
<a name="71"></a>		<span class="source_keyword">for</span> ( <span class="source_type">P</span>=<span class="source_type">Level</span>.ControllerList; <span class="source_type">P</span>!= <span class="source_keyword">None</span>; <span class="source_type">P</span>=<span class="source_type">P</span>.NextController )
<a name="72"></a>		{
<a name="73"></a>			<span class="source_keyword">if</span> ( (<span class="source_type"><a href="../unrealgame/bot.html" class="source">Bot</a></span>(<span class="source_type">P</span>) != <span class="source_keyword">None</span>) && (<span class="source_type"><a href="../unrealgame/bot.html" class="source">Bot</a></span>(<span class="source_type">P</span>).<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span> != <span class="source_keyword">None</span>) && (<span class="source_type">P</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> != <span class="source_keyword">None</span>) && (<span class="source_type">P</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span> == <span class="source_type">Sender</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span>)
<a name="74"></a>				&& ((RecipientID == -<span class="source_int">1</span>) || (RecipientID == <span class="source_type">P</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.TeamID)) )
<a name="75"></a>			{
<a name="76"></a>				<span class="source_type"><a href="../unrealgame/bot.html" class="source">Bot</a></span>(<span class="source_type">P</span>).GetOutOfVehicle();
<a name="77"></a>				<span class="source_keyword">if</span> ( RecipientID == <span class="source_type">P</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.TeamID )
<a name="78"></a>					<span class="source_keyword">break</span>;
<a name="79"></a>			}
<a name="80"></a>		}
<a name="81"></a>		<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="82"></a>	}
<a name="83"></a>
<a name="84"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.ApplyOrder(<span class="source_type">Sender</span>,RecipientID,<span class="source_type">OrderID</span>);
<a name="85"></a>}
<a name="86"></a>
<a name="87"></a><span class="source_keyword">function</span> <span class="source_keyword">int</span> ParseOrder(<span class="source_keyword">string</span> <span class="source_type">OrderString</span>)
<a name="88"></a>{
<a name="89"></a>	<span class="source_keyword">if</span> ( <span class="source_type">OrderString</span> == <span class="source_string">"GET OUT"</span> )
<a name="90"></a>		<span class="source_keyword">return</span> <span class="source_int">299</span>;
<a name="91"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.ParseOrder(<span class="source_type">OrderString</span>);
<a name="92"></a>}
<a name="93"></a>
<a name="94"></a><span class="source_keyword2">static</span> <span class="source_keyword">function</span> PrecacheGameAnnouncements(<span class="source_type"><a href="../engine/announcervoice.html" class="source">AnnouncerVoice</a></span> <span class="source_type">V</span>, <span class="source_keyword">bool</span> <span class="source_type">bRewardSounds</span>)
<a name="95"></a>{
<a name="96"></a>	<span class="source_keyword">Super</span>.PrecacheGameAnnouncements(<span class="source_type">V</span>,<span class="source_type">bRewardSounds</span>);
<a name="97"></a>	<span class="source_keyword">if</span> ( !<span class="source_type">bRewardSounds</span> )
<a name="98"></a>	{
<a name="99"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_powernode_destroyed'</span>);
<a name="100"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_powernode_destroyed'</span>);
<a name="101"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_Powercore_under_attack'</span>);
<a name="102"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_Powercore_under_attack'</span>);
<a name="103"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'NewRoundIn'</span>);
<a name="104"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_Powercore_destroyed'</span>);
<a name="105"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_Powercore_destroyed'</span>);
<a name="106"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_Powercore_critical'</span>);
<a name="107"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_Powercore_critical'</span>);
<a name="108"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_Powercore_vulnerable'</span>);
<a name="109"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_Powercore_vulnerable'</span>);
<a name="110"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_Powernode_under_construction'</span>);
<a name="111"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_Powernode_under_construction'</span>);
<a name="112"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_powercore_damaged'</span>);
<a name="113"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_powercore_damaged'</span>);
<a name="114"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Red_powernode_isolated'</span>);
<a name="115"></a>		<span class="source_type">V</span>.PrecacheSound(<span class="source_name">'Blue_powernode_isolated'</span>);
<a name="116"></a>	}
<a name="117"></a>}
<a name="118"></a>
<a name="119"></a><span class="source_keyword">function</span> SetInitialState()
<a name="120"></a>{
<a name="121"></a>    <span class="source_keyword">Super</span>.SetInitialState();
<a name="122"></a>
<a name="123"></a>    SetCoreDistance(PowerCores[FinalCore[<span class="source_int">0</span>]], <span class="source_int">0</span>, <span class="source_int">0</span>);
<a name="124"></a>    SetCoreDistance(PowerCores[FinalCore[<span class="source_int">1</span>]], <span class="source_int">1</span>, <span class="source_int">0</span>);
<a name="125"></a>
<a name="126"></a>    UpdateLinks();
<a name="127"></a>}
<a name="128"></a>
<a name="129"></a><span class="source_keyword">event</span> InitGame(<span class="source_keyword">string</span> Options, <span class="source_keyword2">out</span> <span class="source_keyword">string</span> <span class="source_type">Error</span>)
<a name="130"></a>{
<a name="131"></a>	<span class="source_keyword">local</span> <span class="source_keyword">string</span> InOpt, <span class="source_type">MapName</span>;
<a name="132"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onspowerlinkofficialsetup.html" class="source">ONSPowerLinkOfficialSetup</a></span> <span class="source_type">P</span>;
<a name="133"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="134"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span> <span class="source_type">N</span>;
<a name="135"></a>	<span class="source_keyword">local</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">string</span>&gt; CustomPowerLinkSetupNames;
<a name="136"></a>
<a name="137"></a>	<span class="source_keyword">Super</span>.InitGame(Options, <span class="source_type">Error</span>);
<a name="138"></a>
<a name="139"></a>	<span class="source_type">x</span> = <span class="source_int">0</span>;
<a name="140"></a>	<span class="source_keyword">for</span>(<span class="source_type">N</span> = <span class="source_type">Level</span>.NavigationPointList; <span class="source_type">N</span> != <span class="source_keyword">None</span>; <span class="source_type">N</span> = <span class="source_type">N</span>.NextNavigationPoint)
<a name="141"></a>	{
<a name="142"></a>		<span class="source_comment">// Reset all PlayerStarts so that the PowerCores can determine their team and Pre-Rate them
</span><a name="143"></a>		<span class="source_keyword">if</span> (<span class="source_type">N</span>.IsA(<span class="source_name">'PlayerStart'</span>))
<a name="144"></a>			<span class="source_type"><a href="../engine/playerstart.html" class="source">PlayerStart</a></span>(<span class="source_type">N</span>).bEnabled = <span class="source_keyword">False</span>;
<a name="145"></a>
<a name="146"></a>		<span class="source_comment">// Register all the PowerCores
</span><a name="147"></a>		<span class="source_keyword">if</span> (<span class="source_type">N</span>.IsA(<span class="source_name">'ONSPowerCore'</span>))
<a name="148"></a>		{
<a name="149"></a>			PowerCores[<span class="source_type">x</span>] = <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>(<span class="source_type">N</span>);
<a name="150"></a>			PowerCores[<span class="source_type">x</span>].NotifyUpdateLinks = UpdateLinks;
<a name="151"></a>			PowerCores[<span class="source_type">x</span>].OnCoreDestroyed = MainCoreDestroyed;
<a name="152"></a>
<a name="153"></a>			<span class="source_keyword">if</span> (PowerCores[<span class="source_type">x</span>].bFinalCore)
<a name="154"></a>				FinalCore[PowerCores[<span class="source_type">x</span>].DefenderTeamIndex] = <span class="source_type">x</span>;
<a name="155"></a>			<span class="source_type">x</span>++;
<a name="156"></a>		}
<a name="157"></a>	}
<a name="158"></a>
<a name="159"></a>	<span class="source_keyword">if</span> (PowerCores.Length == <span class="source_int">0</span>)
<a name="160"></a>	{
<a name="161"></a>		log(<span class="source_string">"Onslaught: Level doesn't have any PowerCores!"</span>,<span class="source_name">'Error'</span>);
<a name="162"></a>		<span class="source_keyword">return</span>;
<a name="163"></a>	}
<a name="164"></a>
<a name="165"></a>	<span class="source_type">MapName</span> = Left(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), InStr(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), <span class="source_string">"."</span>));
<a name="166"></a>
<a name="167"></a>	OfficialPowerLinkSetups.length = <span class="source_int">0</span>;
<a name="168"></a>	<span class="source_keyword">foreach</span> AllActors(<span class="source_keyword">class</span><span class="source_name">'ONSPowerLinkOfficialSetup'</span>, <span class="source_type">P</span>)
<a name="169"></a>		OfficialPowerLinkSetups[OfficialPowerLinkSetups.length] = <span class="source_type">P</span>;
<a name="170"></a>
<a name="171"></a>	<span class="source_comment">//For PerObjectConfig objects, the Outer overrides the default config file name.
</span><a name="172"></a>	<span class="source_comment">//This means by giving the Level as the Outer, the .ini name will be the same as the map name,
</span><a name="173"></a>	<span class="source_comment">//which is really cool because it makes it easy to trade custom setups - just copy that map's .ini
</span><a name="174"></a>	CustomPowerLinkSetupNames = <span class="source_keyword">class</span><span class="source_name">'ONSPowerLinkCustomSetup'</span>.<span class="source_keyword2">static</span>.GetPerObjectNames(<span class="source_type">MapName</span>);
<a name="175"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; CustomPowerLinkSetupNames.length; <span class="source_type">x</span>++)
<a name="176"></a>		CustomPowerLinkSetups[CustomPowerLinkSetups.length] = new(<span class="source_type">Level</span>, CustomPowerLinkSetupNames[<span class="source_type">x</span>]) <span class="source_keyword">class</span><span class="source_name">'ONSPowerLinkCustomSetup'</span>;
<a name="177"></a>
<a name="178"></a>	InOpt = ParseOption(Options, <span class="source_string">"bRandSetupAfterReset"</span>);
<a name="179"></a>	<span class="source_keyword">if</span> (InOpt != <span class="source_string">""</span>)
<a name="180"></a>		bRandSetupAfterReset = <span class="source_keyword">bool</span>(InOpt);
<a name="181"></a>
<a name="182"></a>	InOpt = ParseOption(Options, <span class="source_string">"LinkSetup"</span>);
<a name="183"></a>	<span class="source_keyword">if</span> (InOpt ~= <span class="source_string">"Random"</span>)
<a name="184"></a>	{
<a name="185"></a>		FindLinkSetup();
<a name="186"></a>		<span class="source_keyword">return</span>;
<a name="187"></a>	}
<a name="188"></a>	<span class="source_keyword">if</span> (InOpt == <span class="source_string">""</span> || !SetPowerLinkSetup(InOpt, <span class="source_keyword">None</span>))
<a name="189"></a>	{
<a name="190"></a>		<span class="source_keyword">if</span> (!SetPowerLinkSetup(<span class="source_string">"Default"</span>, <span class="source_keyword">None</span>))
<a name="191"></a>			FindLinkSetup();
<a name="192"></a>	}
<a name="193"></a>
<a name="194"></a>	<span class="source_comment">// Big hack.. you shouldn't break scope this way :)
</span><a name="195"></a>
<a name="196"></a> 	InOpt = ParseOption(Options,<span class="source_string">"BonusVehicles"</span>);
<a name="197"></a>	<span class="source_keyword">if</span> ( <span class="source_keyword">bool</span>(InOpt) )
<a name="198"></a>	{
<a name="199"></a>		AddMutator(<span class="source_string">"OnslaughtBP.MutBonusVehicles"</span>);
<a name="200"></a>	}
<a name="201"></a>
<a name="202"></a>}
<a name="203"></a>
<a name="204"></a><span class="source_keyword">event</span> PostBeginPlay()
<a name="205"></a>{
<a name="206"></a>	SetupLinks();
<a name="207"></a>	<span class="source_keyword">Super</span>.PostBeginPlay();
<a name="208"></a>}
<a name="209"></a>
<a name="210"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> SetupExists(<span class="source_keyword">string</span> SetupName)
<a name="211"></a>{
<a name="212"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="213"></a>
<a name="214"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; OfficialPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="215"></a>		<span class="source_keyword">if</span> (OfficialPowerLinkSetups[<span class="source_type">x</span>].SetupName ~= SetupName)
<a name="216"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="217"></a>
<a name="218"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; CustomPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="219"></a>		<span class="source_keyword">if</span> (<span class="source_keyword">string</span>(CustomPowerLinkSetups[<span class="source_type">x</span>].<span class="source_keyword">Name</span>) ~= SetupName)
<a name="220"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="221"></a>
<a name="222"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="223"></a>}
<a name="224"></a>
<a name="225"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> SetPowerLinkSetup(<span class="source_keyword">string</span> SetupName, <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">Caller</span>)
<a name="226"></a>{
<a name="227"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>, <span class="source_type">y</span>, <span class="source_type">z</span>, <span class="source_type">i</span>;
<a name="228"></a>	<span class="source_keyword">local</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>&gt; Traveled;
<a name="229"></a>
<a name="230"></a>	SetupName = Repl(SetupName, <span class="source_string">" "</span>, <span class="source_string">"_"</span>);
<a name="231"></a>
<a name="232"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; OfficialPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="233"></a>		<span class="source_keyword">if</span> (OfficialPowerLinkSetups[<span class="source_type">x</span>].SetupName ~= SetupName)
<a name="234"></a>		{
<a name="235"></a>			<span class="source_comment">//activate this setup
</span><a name="236"></a>			<span class="source_keyword">for</span> (<span class="source_type">y</span> = <span class="source_int">0</span>; <span class="source_type">y</span> &lt; OfficialPowerLinkSetups[<span class="source_type">x</span>].LinkSetups.length; <span class="source_type">y</span>++)
<a name="237"></a>				<span class="source_keyword">for</span> (<span class="source_type">z</span> = <span class="source_int">0</span>; <span class="source_type">z</span> &lt; PowerCores.length; <span class="source_type">z</span>++)
<a name="238"></a>					<span class="source_keyword">if</span> (PowerCores[<span class="source_type">z</span>].<span class="source_keyword">Name</span> == OfficialPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].BaseNode)
<a name="239"></a>						PowerCores[<span class="source_type">z</span>].LinkedNodes = OfficialPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].LinkedNodes;
<a name="240"></a>			ResetPowerLinks();
<a name="241"></a>			Log(<span class="source_string">"Using Official Link Setup: "</span>$SetupName);
<a name="242"></a>			CurrentSetupName = SetupName;
<a name="243"></a>			bCurrentSetupIsOfficial = <span class="source_keyword">true</span>;
<a name="244"></a>			<span class="source_keyword">if</span> (<span class="source_type">Caller</span> != <span class="source_keyword">None</span>)
<a name="245"></a>				<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">2</span>);
<a name="246"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="247"></a>		}
<a name="248"></a>
<a name="249"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; CustomPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="250"></a>		<span class="source_keyword">if</span> (<span class="source_keyword">string</span>(CustomPowerLinkSetups[<span class="source_type">x</span>].<span class="source_keyword">Name</span>) ~= SetupName)
<a name="251"></a>		{
<a name="252"></a>			<span class="source_comment">//activate this setup
</span><a name="253"></a>			<span class="source_keyword">for</span> (<span class="source_type">y</span> = <span class="source_int">0</span>; <span class="source_type">y</span> &lt; CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups.length; <span class="source_type">y</span>++)
<a name="254"></a>				<span class="source_keyword">for</span> (<span class="source_type">z</span> = <span class="source_int">0</span>; <span class="source_type">z</span> &lt; PowerCores.length; <span class="source_type">z</span>++)
<a name="255"></a>					<span class="source_keyword">if</span> (PowerCores[<span class="source_type">z</span>].<span class="source_keyword">Name</span> == CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].BaseNode)
<a name="256"></a>						PowerCores[<span class="source_type">z</span>].LinkedNodes = CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].LinkedNodes;
<a name="257"></a>			ResetPowerLinks();
<a name="258"></a>			<span class="source_keyword">if</span> (PowerLinks.length &gt; <span class="source_int">0</span> && !ExistsLinkPathTo(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]], Traveled))
<a name="259"></a>			{
<a name="260"></a>				<span class="source_comment">//trying to load an invalid setup, revert to previous one
</span><a name="261"></a>				CustomPowerLinkSetups.Remove(<span class="source_type">x</span>, <span class="source_int">1</span>);
<a name="262"></a>				<span class="source_keyword">if</span> (<span class="source_type">Caller</span> != <span class="source_keyword">None</span>)
<a name="263"></a>					<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">8</span>);
<a name="264"></a>				<span class="source_keyword">else</span>
<a name="265"></a>					Log(<span class="source_string">"Failed to load Custom Link Setup"</span>@SetupName$<span class="source_string">": There is not a complete path between the PowerCores."</span>);
<a name="266"></a>				<span class="source_keyword">if</span> (CurrentSetupName != <span class="source_string">""</span> && CurrentSetupName != SetupName && SetPowerLinkSetup(CurrentSetupName, <span class="source_keyword">None</span>))
<a name="267"></a>					<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="268"></a>				<span class="source_keyword">if</span> (OfficialPowerLinkSetups.Length &gt; <span class="source_int">0</span>)
<a name="269"></a>				{
<a name="270"></a>					FindLinkSetup();
<a name="271"></a>					<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="272"></a>				}
<a name="273"></a>				Log(<span class="source_string">"Can't find a better link setup to load, so using"</span>@SetupName@<span class="source_string">" anyway and forcing a connection between the PowerCores."</span>);
<a name="274"></a>				AddLink(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]]);
<a name="275"></a>				UpdateLinks();
<a name="276"></a>				<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; <span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray.Length; <span class="source_type">i</span>++)
<a name="277"></a>					<span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>].<span class="source_type">Owner</span>) != <span class="source_keyword">None</span> && <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>]) != <span class="source_keyword">None</span>)
<a name="278"></a>						<span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>]).ClientReceivePowerLink(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]]);
<a name="279"></a>				<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="280"></a>			}
<a name="281"></a>			Log(<span class="source_string">"Using Custom Link Setup: "</span>$SetupName);
<a name="282"></a>			CurrentSetupName = SetupName;
<a name="283"></a>			bCurrentSetupIsOfficial = <span class="source_keyword">false</span>;
<a name="284"></a>			<span class="source_keyword">if</span> (<span class="source_type">Caller</span> != <span class="source_keyword">None</span>)
<a name="285"></a>				<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">2</span>);
<a name="286"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="287"></a>		}
<a name="288"></a>
<a name="289"></a>	<span class="source_keyword">if</span> (<span class="source_type">Caller</span> != <span class="source_keyword">None</span>)
<a name="290"></a>		<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">3</span>);
<a name="291"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="292"></a>}
<a name="293"></a>
<a name="294"></a><span class="source_keyword">function</span> ClearLinks()
<a name="295"></a>{
<a name="296"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="297"></a>
<a name="298"></a>	<span class="source_keyword">for</span> ( <span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerLinks.Length; <span class="source_type">i</span>++ )
<a name="299"></a>		<span class="source_keyword">if</span> ( PowerLinks[<span class="source_type">i</span>] != <span class="source_keyword">None</span> )
<a name="300"></a>			PowerLinks[<span class="source_type">i</span>].Destroy();
<a name="301"></a>
<a name="302"></a>	PowerLinks.Remove(<span class="source_int">0</span>, PowerLinks.Length);
<a name="303"></a>}
<a name="304"></a>
<a name="305"></a><span class="source_keyword">function</span> ResetPowerLinks()
<a name="306"></a>{
<a name="307"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="308"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span> PRI;
<a name="309"></a>
<a name="310"></a>	<span class="source_keyword">if</span> ( PowerLinks.Length == <span class="source_int">0</span> )
<a name="311"></a>		<span class="source_keyword">return</span>;
<a name="312"></a>
<a name="313"></a>	ClearLinks();
<a name="314"></a>
<a name="315"></a>	<span class="source_keyword">for</span> ( <span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; PowerCores.Length; <span class="source_type">x</span>++ )
<a name="316"></a>		PowerCores[<span class="source_type">x</span>].ResetLinks();
<a name="317"></a>
<a name="318"></a>	SetupLinks();
<a name="319"></a>
<a name="320"></a>	<span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span> != <span class="source_keyword">None</span>)
<a name="321"></a>	{
<a name="322"></a>		<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; <span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray.length; <span class="source_type">x</span>++)
<a name="323"></a>		{
<a name="324"></a>			PRI = <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">x</span>]);
<a name="325"></a>			<span class="source_keyword">if</span> ( PRI == <span class="source_keyword">None</span> || <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(PRI.<span class="source_type">Owner</span>) == <span class="source_keyword">None</span> )
<a name="326"></a>				continue;
<a name="327"></a>
<a name="328"></a>			PRI.ClientPrepareToReceivePowerLinks();
<a name="329"></a>		}
<a name="330"></a>	}
<a name="331"></a>}
<a name="332"></a>
<a name="333"></a><span class="source_comment">//Save a powercore link setup. Returns true if it successfully created a NEW setup and neither failed nor overwrote an old setup
</span><a name="334"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> SavePowerLinkSetup(<span class="source_keyword">string</span> SetupName, <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">Caller</span>)
<a name="335"></a>{
<a name="336"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>, <span class="source_type">y</span>, <span class="source_type">z</span>;
<a name="337"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onsonslaughtgame.html#PowerLinkSetup" class="source">PowerLinkSetup</a></span> BlankSetup;
<a name="338"></a>	<span class="source_keyword">local</span> <span class="source_keyword">string</span> <span class="source_type">MapName</span>;
<a name="339"></a>
<a name="340"></a>	<span class="source_type">MapName</span> = Left(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), InStr(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), <span class="source_string">"."</span>));
<a name="341"></a>	SetupName = Repl(SetupName, <span class="source_string">" "</span>, <span class="source_string">"_"</span>);
<a name="342"></a>
<a name="343"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; OfficialPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="344"></a>		<span class="source_keyword">if</span> (OfficialPowerLinkSetups[<span class="source_type">x</span>].SetupName ~= SetupName)
<a name="345"></a>		{
<a name="346"></a>			<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">1</span>);
<a name="347"></a>			<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="348"></a>		}
<a name="349"></a>
<a name="350"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; CustomPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="351"></a>		<span class="source_keyword">if</span> (<span class="source_keyword">string</span>(CustomPowerLinkSetups[<span class="source_type">x</span>].<span class="source_keyword">Name</span>) ~= SetupName)
<a name="352"></a>		{
<a name="353"></a>			<span class="source_comment">//overwrite
</span><a name="354"></a>			CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups.length = <span class="source_int">0</span>;
<a name="355"></a>			<span class="source_keyword">for</span> (<span class="source_type">y</span> = <span class="source_int">0</span>; <span class="source_type">y</span> &lt; PowerCores.length; <span class="source_type">y</span>++)
<a name="356"></a>			{
<a name="357"></a>				CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>] = BlankSetup;
<a name="358"></a>				CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].BaseNode = PowerCores[<span class="source_type">y</span>].<span class="source_keyword">Name</span>;
<a name="359"></a>				<span class="source_keyword">for</span> (<span class="source_type">z</span> = <span class="source_int">0</span>; <span class="source_type">z</span> &lt; PowerCores[<span class="source_type">y</span>].PowerLinks.length; <span class="source_type">z</span>++)
<a name="360"></a>					CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].LinkedNodes[<span class="source_type">z</span>] = PowerCores[<span class="source_type">y</span>].PowerLinks[<span class="source_type">z</span>].<span class="source_keyword">Name</span>;
<a name="361"></a>			}
<a name="362"></a>			CustomPowerLinkSetups[<span class="source_type">x</span>].SaveConfig();
<a name="363"></a>			<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">0</span>);
<a name="364"></a>			<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="365"></a>		}
<a name="366"></a>
<a name="367"></a>	<span class="source_comment">//save new
</span><a name="368"></a>	<span class="source_type">x</span> = CustomPowerLinkSetups.length;
<a name="369"></a>	CustomPowerLinkSetups.length = CustomPowerLinkSetups.length + <span class="source_int">1</span>;
<a name="370"></a>	CustomPowerLinkSetups[<span class="source_type">x</span>] = new(<span class="source_type">Level</span>, SetupName) <span class="source_keyword">class</span><span class="source_name">'ONSPowerLinkCustomSetup'</span>;
<a name="371"></a>	CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups.length = <span class="source_int">0</span>;
<a name="372"></a>	<span class="source_keyword">for</span> (<span class="source_type">y</span> = <span class="source_int">0</span>; <span class="source_type">y</span> &lt; PowerCores.length; <span class="source_type">y</span>++)
<a name="373"></a>	{
<a name="374"></a>		CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>] = BlankSetup;
<a name="375"></a>		CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].BaseNode = PowerCores[<span class="source_type">y</span>].<span class="source_keyword">Name</span>;
<a name="376"></a>		<span class="source_keyword">for</span> (<span class="source_type">z</span> = <span class="source_int">0</span>; <span class="source_type">z</span> &lt; PowerCores[<span class="source_type">y</span>].PowerLinks.length; <span class="source_type">z</span>++)
<a name="377"></a>			CustomPowerLinkSetups[<span class="source_type">x</span>].LinkSetups[<span class="source_type">y</span>].LinkedNodes[<span class="source_type">z</span>] = PowerCores[<span class="source_type">y</span>].PowerLinks[<span class="source_type">z</span>].<span class="source_keyword">Name</span>;
<a name="378"></a>	}
<a name="379"></a>	CustomPowerLinkSetups[<span class="source_type">x</span>].SaveConfig();
<a name="380"></a>	<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">0</span>);
<a name="381"></a>
<a name="382"></a>	<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="383"></a>}
<a name="384"></a>
<a name="385"></a><span class="source_comment">//Deletes a powercore link setup. Returns true if successful, false if not
</span><a name="386"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> DeletePowerLinkSetup(<span class="source_keyword">string</span> SetupName, <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">Caller</span>)
<a name="387"></a>{
<a name="388"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="389"></a>	<span class="source_keyword">local</span> <span class="source_keyword">string</span> <span class="source_type">MapName</span>;
<a name="390"></a>
<a name="391"></a>	<span class="source_type">MapName</span> = Left(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), InStr(<span class="source_keyword">string</span>(<span class="source_type">Level</span>), <span class="source_string">"."</span>));
<a name="392"></a>	SetupName = Repl(SetupName, <span class="source_string">" "</span>, <span class="source_string">"_"</span>);
<a name="393"></a>
<a name="394"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; OfficialPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="395"></a>		<span class="source_keyword">if</span> (OfficialPowerLinkSetups[<span class="source_type">x</span>].SetupName ~= SetupName)
<a name="396"></a>		{
<a name="397"></a>			<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">5</span>);
<a name="398"></a>			<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="399"></a>		}
<a name="400"></a>
<a name="401"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; CustomPowerLinkSetups.length; <span class="source_type">x</span>++)
<a name="402"></a>		<span class="source_keyword">if</span> (<span class="source_keyword">string</span>(CustomPowerLinkSetups[<span class="source_type">x</span>].<span class="source_keyword">Name</span>) ~= SetupName)
<a name="403"></a>		{
<a name="404"></a>			CustomPowerLinkSetups[<span class="source_type">x</span>].ClearConfig();
<a name="405"></a>			CustomPowerLinkSetups.Remove(<span class="source_type">x</span>, <span class="source_int">1</span>);
<a name="406"></a>			<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">4</span>);
<a name="407"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="408"></a>		}
<a name="409"></a>
<a name="410"></a>	<span class="source_type">Caller</span>.ReceiveLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSLinkDesignMessage'</span>, <span class="source_int">6</span>);
<a name="411"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="412"></a>}
<a name="413"></a>
<a name="414"></a><span class="source_keyword">function</span> FindLinkSetup(<span class="source_keyword2">optional</span> <span class="source_keyword">string</span> IgnoredSetup)
<a name="415"></a>{
<a name="416"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>, Sanity, TotalNumSetups;
<a name="417"></a>	<span class="source_keyword">local</span> <span class="source_keyword">string</span> NewSetupName;
<a name="418"></a>
<a name="419"></a>	TotalNumSetups = OfficialPowerLinkSetups.length + CustomPowerLinkSetups.length;
<a name="420"></a>
<a name="421"></a>	<span class="source_keyword">if</span> (TotalNumSetups == <span class="source_int">0</span>)
<a name="422"></a>		Log(<span class="source_string">"Using default Link Setup"</span>);
<a name="423"></a>	<span class="source_keyword">else</span> <span class="source_keyword">if</span> (TotalNumSetups == <span class="source_int">1</span> && CurrentSetupName != <span class="source_string">""</span>)
<a name="424"></a>		SetPowerLinkSetup(CurrentSetupName, <span class="source_keyword">None</span>);
<a name="425"></a>	<span class="source_keyword">else</span>
<a name="426"></a>	{
<a name="427"></a>		do
<a name="428"></a>		{
<a name="429"></a>			<span class="source_type">i</span> = Rand(TotalNumSetups);
<a name="430"></a>			<span class="source_keyword">if</span> (<span class="source_type">i</span> &lt; OfficialPowerLinkSetups.length)
<a name="431"></a>				NewSetupName = OfficialPowerLinkSetups[<span class="source_type">i</span>].SetupName;
<a name="432"></a>			<span class="source_keyword">else</span>
<a name="433"></a>				NewSetupName = <span class="source_keyword">string</span>(CustomPowerLinkSetups[<span class="source_type">i</span>-OfficialPowerLinkSetups.length].<span class="source_keyword">Name</span>);
<a name="434"></a>			Sanity++;
<a name="435"></a>		} until (NewSetupName != IgnoredSetup || Sanity &gt; <span class="source_int">1000</span>)
<a name="436"></a>
<a name="437"></a>		SetPowerLinkSetup(NewSetupName, <span class="source_keyword">None</span>);
<a name="438"></a>	}
<a name="439"></a>}
<a name="440"></a>
<a name="441"></a><span class="source_keyword2">static</span> <span class="source_keyword2">simulated</span> <span class="source_keyword">function</span> <span class="source_keyword">bool</span> ExistsLinkPathTo(<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">Start</span>, <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> Destination, <span class="source_keyword2">out</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>&gt; Traveled)
<a name="442"></a>{
<a name="443"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>, j;
<a name="444"></a>	<span class="source_keyword">local</span> <span class="source_keyword">bool</span> bSkip;
<a name="445"></a>
<a name="446"></a>	<span class="source_keyword">if</span> (<span class="source_type">Start</span> == <span class="source_keyword">None</span> || Destination == <span class="source_keyword">None</span>)
<a name="447"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="448"></a>
<a name="449"></a>	Traveled[Traveled.length] = <span class="source_type">Start</span>;
<a name="450"></a>
<a name="451"></a>	<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; <span class="source_type">Start</span>.PowerLinks.Length; <span class="source_type">i</span>++)
<a name="452"></a>	{
<a name="453"></a>		<span class="source_keyword">if</span> (<span class="source_type">Start</span>.PowerLinks[<span class="source_type">i</span>] == Destination)
<a name="454"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="455"></a>		bSkip = <span class="source_keyword">false</span>;
<a name="456"></a>		<span class="source_keyword">for</span> (j = <span class="source_int">0</span>; j &lt; Traveled.length; j++)
<a name="457"></a>		{
<a name="458"></a>			<span class="source_keyword">if</span> (Traveled[j] == <span class="source_type">Start</span>.PowerLinks[<span class="source_type">i</span>])
<a name="459"></a>			{
<a name="460"></a>				bSkip = <span class="source_keyword">true</span>;
<a name="461"></a>				<span class="source_keyword">break</span>;
<a name="462"></a>			}
<a name="463"></a>		}
<a name="464"></a>		<span class="source_keyword">if</span> (!bSkip && ExistsLinkPathTo(<span class="source_type">Start</span>.PowerLinks[<span class="source_type">i</span>], Destination, Traveled))
<a name="465"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="466"></a>	}
<a name="467"></a>
<a name="468"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="469"></a>}
<a name="470"></a>
<a name="471"></a><span class="source_keyword">function</span> SetCoreDistance(<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">PC</span>, <span class="source_keyword">byte</span> <span class="source_type">T</span>, <span class="source_keyword">byte</span> <span class="source_type">Distance</span>)
<a name="472"></a>{
<a name="473"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="474"></a>
<a name="475"></a>    <span class="source_type">PC</span>.FinalCoreDistance[<span class="source_type">T</span>] = <span class="source_type">Distance</span>;
<a name="476"></a>
<a name="477"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span>=<span class="source_int">0</span>; <span class="source_type">i</span>&lt;<span class="source_type">PC</span>.PowerLinks.Length; <span class="source_type">i</span>++)
<a name="478"></a>    {
<a name="479"></a>        <span class="source_keyword">if</span> (<span class="source_type">PC</span>.PowerLinks[<span class="source_type">i</span>].FinalCoreDistance[<span class="source_type">T</span>] &gt; <span class="source_type">Distance</span> + <span class="source_int">1</span>)
<a name="480"></a>            SetCoreDistance(<span class="source_type">PC</span>.PowerLinks[<span class="source_type">i</span>], <span class="source_type">T</span>, <span class="source_type">Distance</span> + <span class="source_int">1</span>);
<a name="481"></a>    }
<a name="482"></a>}
<a name="483"></a>
<a name="484"></a><span class="source_keyword">function</span> UpdateLinks()
<a name="485"></a>{
<a name="486"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>, j;
<a name="487"></a>    <span class="source_keyword">local</span> <span class="source_keyword">bool</span> bRedCoreWasVulnerable, bBlueCoreWasVulnerable;
<a name="488"></a>
<a name="489"></a>    <span class="source_keyword">if</span> (!bScriptInitialized)	<span class="source_comment">//PowerCores haven't done PostBeginPlay() yet
</span><a name="490"></a>        <span class="source_keyword">return</span>;
<a name="491"></a>
<a name="492"></a><span class="source_comment">//	log(Name@"UpdateLinks");
</span><a name="493"></a>    bRedCoreWasVulnerable = PowerCores[FinalCore[<span class="source_int">0</span>]].bPoweredByBlue;
<a name="494"></a>    bBlueCoreWasVulnerable = PowerCores[FinalCore[<span class="source_int">1</span>]].bPoweredByRed;
<a name="495"></a>
<a name="496"></a>    UpdateSeveredLinks();
<a name="497"></a>
<a name="498"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span>=<span class="source_int">0</span>; <span class="source_type">i</span>&lt;PowerCores.Length; <span class="source_type">i</span>++)
<a name="499"></a>    {
<a name="500"></a>        PowerCores[<span class="source_type">i</span>].bPoweredByRed = <span class="source_keyword">False</span>;
<a name="501"></a>        PowerCores[<span class="source_type">i</span>].bPoweredByBlue = <span class="source_keyword">False</span>;
<a name="502"></a>        <span class="source_keyword">for</span> (j=<span class="source_int">0</span>; j&lt;PowerCores[<span class="source_type">i</span>].PowerLinks.Length; j++)
<a name="503"></a>            <span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].PowerLinks[j].CoreStage == <span class="source_int">0</span> && !PowerCores[<span class="source_type">i</span>].PowerLinks[j].bSevered)
<a name="504"></a>            {
<a name="505"></a>                <span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].PowerLinks[j].DefenderTeamIndex == <span class="source_int">0</span>)
<a name="506"></a>                    PowerCores[<span class="source_type">i</span>].bPoweredByRed = <span class="source_keyword">True</span>;
<a name="507"></a>                <span class="source_keyword">else</span> <span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].PowerLinks[j].DefenderTeamIndex == <span class="source_int">1</span>)
<a name="508"></a>                    PowerCores[<span class="source_type">i</span>].bPoweredByBlue = <span class="source_keyword">True</span>;
<a name="509"></a>            }
<a name="510"></a>
<a name="511"></a>	<span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].CoreStage == <span class="source_int">4</span> && (PowerCores[<span class="source_type">i</span>].bPoweredByRed || PowerCores[<span class="source_type">i</span>].bPoweredByBlue))
<a name="512"></a>		PowerCores[<span class="source_type">i</span>].CheckTouching();
<a name="513"></a>        PowerCores[<span class="source_type">i</span>].CheckShield();
<a name="514"></a>    }
<a name="515"></a>
<a name="516"></a>    <span class="source_keyword">if</span> (!bRedCoreWasVulnerable && PowerCores[FinalCore[<span class="source_int">0</span>]].bPoweredByBlue)
<a name="517"></a>    	BroadcastLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSOnslaughtMessage'</span>, <span class="source_int">20</span>);
<a name="518"></a>    <span class="source_keyword">if</span> (!bBlueCoreWasVulnerable && PowerCores[FinalCore[<span class="source_int">1</span>]].bPoweredByRed)
<a name="519"></a>    	BroadcastLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSOnslaughtMessage'</span>, <span class="source_int">21</span>);
<a name="520"></a>}
<a name="521"></a>
<a name="522"></a><span class="source_keyword">function</span> UpdateSeveredLinks()
<a name="523"></a>{
<a name="524"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="525"></a>    <span class="source_keyword">local</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">byte</span>&gt; WasSevered;
<a name="526"></a>
<a name="527"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerCores.Length; <span class="source_type">i</span>++)
<a name="528"></a>    {
<a name="529"></a>        WasSevered[<span class="source_type">i</span>] = <span class="source_keyword">byte</span>(PowerCores[<span class="source_type">i</span>].bSevered);
<a name="530"></a>        PowerCores[<span class="source_type">i</span>].bSevered = <span class="source_keyword">True</span>;
<a name="531"></a>    }
<a name="532"></a>
<a name="533"></a>    Sever(PowerCores[FinalCore[<span class="source_int">0</span>]], <span class="source_int">0</span>);
<a name="534"></a>    Sever(PowerCores[FinalCore[<span class="source_int">1</span>]], <span class="source_int">1</span>);
<a name="535"></a>
<a name="536"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerCores.Length; <span class="source_type">i</span>++)
<a name="537"></a>        <span class="source_keyword">if</span> (!PowerCores[<span class="source_type">i</span>].bDisabled && PowerCores[<span class="source_type">i</span>].CoreStage != <span class="source_int">4</span>)
<a name="538"></a>        {
<a name="539"></a>            <span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].bSevered && WasSevered[<span class="source_type">i</span>] == <span class="source_int">0</span>)
<a name="540"></a>		PowerCores[<span class="source_type">i</span>].Sever();
<a name="541"></a>	    <span class="source_keyword">else</span> <span class="source_keyword">if</span> (!PowerCores[<span class="source_type">i</span>].bSevered && WasSevered[<span class="source_type">i</span>] == <span class="source_int">1</span>)
<a name="542"></a>	    	PowerCores[<span class="source_type">i</span>].UnSever();
<a name="543"></a>	}
<a name="544"></a>}
<a name="545"></a>
<a name="546"></a><span class="source_keyword">function</span> Sever(<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">PC</span>, <span class="source_keyword">int</span> TeamIndex)
<a name="547"></a>{
<a name="548"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="549"></a>    <span class="source_type">PC</span>.bSevered = <span class="source_keyword">False</span>;
<a name="550"></a>    <span class="source_keyword">if</span> (<span class="source_type">PC</span>.CoreStage != <span class="source_int">0</span>)
<a name="551"></a>        <span class="source_keyword">return</span>;
<a name="552"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; <span class="source_type">PC</span>.PowerLinks.Length; <span class="source_type">i</span>++)
<a name="553"></a>        <span class="source_keyword">if</span> (<span class="source_type">PC</span>.PowerLinks[<span class="source_type">i</span>].bSevered && <span class="source_type">PC</span>.PowerLinks[<span class="source_type">i</span>].DefenderTeamIndex == TeamIndex)
<a name="554"></a>            Sever(<span class="source_type">PC</span>.PowerLinks[<span class="source_type">i</span>], TeamIndex);
<a name="555"></a>}
<a name="556"></a>
<a name="557"></a><span class="source_keyword">function</span> Reset()
<a name="558"></a>{
<a name="559"></a>	bOverTime = <span class="source_keyword">false</span>;
<a name="560"></a>	bOverTimeBroadcast = <span class="source_keyword">false</span>;
<a name="561"></a>}
<a name="562"></a>
<a name="563"></a><span class="source_keyword">function</span> StartMatch()
<a name="564"></a>{
<a name="565"></a>	<span class="source_keyword">local</span> <span class="source_keyword">array</span>&lt;<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>&gt; Traveled;
<a name="566"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="567"></a>
<a name="568"></a>	<span class="source_comment">//check if the link setup is valid (in case host/admin edited it before game start)
</span><a name="569"></a>	<span class="source_keyword">if</span> (<span class="source_type">Level</span>.NetMode != NM_Standalone && !ExistsLinkPathTo(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]], Traveled))
<a name="570"></a>	{
<a name="571"></a>		<span class="source_comment">//trying to load an invalid setup, revert to previous one
</span><a name="572"></a>		Log(<span class="source_string">"Current link setup is invalid: There is not a complete path between the PowerCores."</span>);
<a name="573"></a>		<span class="source_keyword">if</span> (CurrentSetupName == <span class="source_string">""</span> || !SetPowerLinkSetup(CurrentSetupName, <span class="source_keyword">None</span>))
<a name="574"></a>		{
<a name="575"></a>			<span class="source_keyword">if</span> (OfficialPowerLinkSetups.length &gt; <span class="source_int">0</span>)
<a name="576"></a>				FindLinkSetup();
<a name="577"></a>			<span class="source_keyword">else</span>
<a name="578"></a>			{
<a name="579"></a>				Log(<span class="source_string">"Can't find a better link setup to load, so forcing a connection between the PowerCores."</span>);
<a name="580"></a>				AddLink(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]]);
<a name="581"></a>				UpdateLinks();
<a name="582"></a>				<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; <span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray.Length; <span class="source_type">i</span>++)
<a name="583"></a>					<span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>].<span class="source_type">Owner</span>) != <span class="source_keyword">None</span> && <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>]) != <span class="source_keyword">None</span>)
<a name="584"></a>						<span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.PRIArray[<span class="source_type">i</span>]).ClientReceivePowerLink(PowerCores[FinalCore[<span class="source_int">0</span>]], PowerCores[FinalCore[<span class="source_int">1</span>]]);
<a name="585"></a>			}
<a name="586"></a>		}
<a name="587"></a>	}
<a name="588"></a>
<a name="589"></a>	<span class="source_keyword">Super</span>.StartMatch();
<a name="590"></a>}
<a name="591"></a>
<a name="592"></a><span class="source_keyword">State</span> MatchInProgress
<a name="593"></a>{
<a name="594"></a>	<span class="source_keyword">event</span> Timer()
<a name="595"></a>	{
<a name="596"></a>        <span class="source_keyword">local</span> <span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">C</span>;
<a name="597"></a>    	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>, TeamNodes[<span class="source_int">2</span>], TotalNodes;
<a name="598"></a>    	<span class="source_keyword">local</span> <span class="source_type"><a href="../engine/actor.html" class="source">Actor</a></span> <span class="source_type">A</span>;
<a name="599"></a>    	<span class="source_keyword">local</span> <span class="source_keyword">bool</span> bOldUnderAttack;
<a name="600"></a>
<a name="601"></a>        <span class="source_keyword">for</span>(<span class="source_type">i</span>=<span class="source_int">0</span>;<span class="source_type">i</span>&lt;PowerCores.Length;<span class="source_type">i</span>++)
<a name="602"></a>        {
<a name="603"></a>        	<span class="source_keyword">if</span> ( <span class="source_type">Level</span>.TimeSeconds &gt; PowerCores[<span class="source_type">i</span>].LastAttackExpirationTime )
<a name="604"></a>        	{
<a name="605"></a>	            bOldUnderAttack = PowerCores[<span class="source_type">i</span>].bUnderAttack;
<a name="606"></a>	            PowerCores[<span class="source_type">i</span>].bUnderAttack = (<span class="source_type">Level</span>.TimeSeconds - PowerCores[<span class="source_type">i</span>].LastAttackTime &lt; PowerCores[<span class="source_type">i</span>].LastAttackExpirationTime);
<a name="607"></a>	            <span class="source_keyword">if</span> (bOldUnderAttack != PowerCores[<span class="source_type">i</span>].bUnderAttack)
<a name="608"></a>	                PowerCores[<span class="source_type">i</span>].UnderAttackChange();
<a name="609"></a>	        }
<a name="610"></a>
<a name="611"></a>            <span class="source_keyword">if</span> (!PowerCores[<span class="source_type">i</span>].bFinalCore && PowerCores[<span class="source_type">i</span>].CoreStage != <span class="source_int">255</span>)
<a name="612"></a>    	    {
<a name="613"></a>    	    	<span class="source_keyword">if</span> (PowerCores[<span class="source_type">i</span>].CoreStage == <span class="source_int">0</span> && PowerCores[<span class="source_type">i</span>].DefenderTeamIndex &lt; <span class="source_int">2</span>)
<a name="614"></a>    	            	TeamNodes[PowerCores[<span class="source_type">i</span>].DefenderTeamIndex]++;
<a name="615"></a>    	        TotalNodes++;
<a name="616"></a>    	    }
<a name="617"></a>        }
<a name="618"></a>
<a name="619"></a>        <span class="source_keyword">if</span> (bOverTime)
<a name="620"></a>        {
<a name="621"></a>        	PowerCores[FinalCore[<span class="source_int">0</span>]].TakeDamage(OvertimeCoreDrainPerSec - OvertimeCoreDrainPerSec * (<span class="source_keyword">float</span>(TeamNodes[<span class="source_int">0</span>]) / TotalNodes), <span class="source_keyword">None</span>, vect(<span class="source_int">0</span>,<span class="source_int">0</span>,<span class="source_int">0</span>), vect(<span class="source_int">0</span>,<span class="source_int">0</span>,<span class="source_int">0</span>), <span class="source_keyword">None</span>);
<a name="622"></a>        	PowerCores[FinalCore[<span class="source_int">1</span>]].TakeDamage(OvertimeCoreDrainPerSec - OvertimeCoreDrainPerSec * (<span class="source_keyword">float</span>(TeamNodes[<span class="source_int">1</span>]) / TotalNodes), <span class="source_keyword">None</span>, vect(<span class="source_int">0</span>,<span class="source_int">0</span>,<span class="source_int">0</span>), vect(<span class="source_int">0</span>,<span class="source_int">0</span>,<span class="source_int">0</span>), <span class="source_keyword">None</span>);
<a name="623"></a>        }
<a name="624"></a>
<a name="625"></a>        <span class="source_keyword">Super</span>.Timer(); <span class="source_comment">// Need this!!!
</span><a name="626"></a>
<a name="627"></a>        <span class="source_keyword">if</span> (ResetCountDown &gt; <span class="source_int">0</span>)
<a name="628"></a>        {
<a name="629"></a>            ResetCountDown--;
<a name="630"></a>            <span class="source_keyword">if</span> ( ResetCountDown &lt; <span class="source_int">3</span> )
<a name="631"></a>            {
<a name="632"></a>				<span class="source_comment">// blow up all redeemer guided warheads
</span><a name="633"></a>				<span class="source_keyword">for</span> ( <span class="source_type">C</span>=<span class="source_type">Level</span>.ControllerList; <span class="source_type">C</span>!=<span class="source_keyword">None</span>; <span class="source_type">C</span>=<span class="source_type">C</span>.NextController )
<a name="634"></a>					<span class="source_keyword">if</span> ( (<span class="source_type">C</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span> != <span class="source_keyword">None</span>) && <span class="source_type">C</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.IsA(<span class="source_name">'RedeemerWarhead'</span>) )
<a name="635"></a>						<span class="source_type">C</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.Fire(<span class="source_int">1</span>);
<a name="636"></a>
<a name="637"></a>			}
<a name="638"></a>            <span class="source_keyword">if</span> ( ResetCountDown == <span class="source_int">8</span> )
<a name="639"></a>            {
<a name="640"></a>                <span class="source_keyword">for</span> ( <span class="source_type">C</span> = <span class="source_type">Level</span>.ControllerList; <span class="source_type">C</span> != <span class="source_keyword">None</span>; <span class="source_type">C</span> = <span class="source_type">C</span>.NextController )
<a name="641"></a>                    <span class="source_keyword">if</span> ( <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">C</span>) != <span class="source_keyword">None</span> )
<a name="642"></a>                        <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">C</span>).PlayStatusAnnouncement(<span class="source_name">'NewRoundIn'</span>,<span class="source_int">1</span>,<span class="source_keyword">true</span>);
<a name="643"></a>            }
<a name="644"></a>            <span class="source_keyword">else</span> <span class="source_keyword">if</span> ( (ResetCountDown &gt; <span class="source_int">1</span>) && (ResetCountDown &lt; <span class="source_int">7</span>) )
<a name="645"></a>                BroadcastLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'TimerMessage'</span>, ResetCountDown-<span class="source_int">1</span>);
<a name="646"></a>            <span class="source_keyword">else</span> <span class="source_keyword">if</span> (ResetCountDown == <span class="source_int">1</span>)
<a name="647"></a>            {
<a name="648"></a>                Log(<span class="source_string">"Reset Onslaught."</span>);
<a name="649"></a>
<a name="650"></a>            	<span class="source_keyword">for</span> (<span class="source_type">C</span> = <span class="source_type">Level</span>.ControllerList; <span class="source_type">C</span> != <span class="source_keyword">None</span>; <span class="source_type">C</span> = <span class="source_type">C</span>.NextController)
<a name="651"></a>            	{
<a name="652"></a>                    <span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">C</span>) != <span class="source_keyword">None</span>)
<a name="653"></a>                        <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">C</span>).ClientReset();
<a name="654"></a>                    <span class="source_type">C</span>.Reset();
<a name="655"></a>                }
<a name="656"></a>
<a name="657"></a>            	<span class="source_keyword">foreach</span> AllActors(<span class="source_keyword">class</span><span class="source_name">'Actor'</span>, <span class="source_type">A</span>)
<a name="658"></a>            		<span class="source_keyword">if</span> (!<span class="source_type">A</span>.IsA(<span class="source_name">'Controller'</span>) && !<span class="source_type">A</span>.IsA(<span class="source_name">'ONSPowerCore'</span>) && !<span class="source_type">A</span>.IsA(<span class="source_name">'TeamInfo'</span>))
<a name="659"></a>            			<span class="source_type">A</span>.Reset();
<a name="660"></a>
<a name="661"></a>            	<span class="source_comment">//we reset powercores after everything else because their reset might cause
</span><a name="662"></a>            	<span class="source_comment">//vehiclefactories, etc to activate and spawn new actors that we don't want to affect
</span><a name="663"></a>            	<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerCores.length; <span class="source_type">i</span>++)
<a name="664"></a>            	{
<a name="665"></a>                    <span class="source_keyword">if</span> (bSwapSidesAfterReset && PowerCores[<span class="source_type">i</span>].bFinalCore)
<a name="666"></a>                    {
<a name="667"></a>                        <span class="source_keyword">if</span> (bSidesAreSwitched)
<a name="668"></a>                            PowerCores[<span class="source_type">i</span>].DefenderTeamIndex = PowerCores[<span class="source_type">i</span>].default.DefenderTeamIndex;
<a name="669"></a>                        <span class="source_keyword">else</span>
<a name="670"></a>                            PowerCores[<span class="source_type">i</span>].DefenderTeamIndex = abs(PowerCores[<span class="source_type">i</span>].default.DefenderTeamIndex - <span class="source_int">1</span>);
<a name="671"></a>
<a name="672"></a>                        FinalCore[PowerCores[<span class="source_type">i</span>].DefenderTeamIndex] = <span class="source_type">i</span>;
<a name="673"></a>                    }
<a name="674"></a>                    <span class="source_keyword">else</span>
<a name="675"></a>                        PowerCores[<span class="source_type">i</span>].DefenderTeamIndex = PowerCores[<span class="source_type">i</span>].default.DefenderTeamIndex;
<a name="676"></a>
<a name="677"></a>                    PowerCores[<span class="source_type">i</span>].FinalCoreDistance[<span class="source_int">0</span>] = <span class="source_int">255</span>;
<a name="678"></a>                    PowerCores[<span class="source_type">i</span>].FinalCoreDistance[<span class="source_int">1</span>] = <span class="source_int">255</span>;
<a name="679"></a>
<a name="680"></a>            		PowerCores[<span class="source_type">i</span>].Reset();
<a name="681"></a>            	}
<a name="682"></a>
<a name="683"></a>            	<span class="source_keyword">if</span> (bSwapSidesAfterReset)
<a name="684"></a>            	{
<a name="685"></a>                    SetCoreDistance(PowerCores[FinalCore[<span class="source_int">0</span>]], <span class="source_int">0</span>, <span class="source_int">0</span>);
<a name="686"></a>                    SetCoreDistance(PowerCores[FinalCore[<span class="source_int">1</span>]], <span class="source_int">1</span>, <span class="source_int">0</span>);
<a name="687"></a>                    bSidesAreSwitched = !bSidesAreSwitched;
<a name="688"></a>                }
<a name="689"></a>
<a name="690"></a>        		<span class="source_comment">//possibly choose a new link setup
</span><a name="691"></a>            	<span class="source_keyword">if</span> (bRandSetupAfterReset && (OfficialPowerLinkSetups.length + CustomPowerLinkSetups.length) &gt; <span class="source_int">1</span>)
<a name="692"></a>            		FindLinkSetup(CurrentSetupName);
<a name="693"></a>            	<span class="source_keyword">else</span>
<a name="694"></a>            		UpdateLinks();
<a name="695"></a>
<a name="696"></a>                FindNewObjectives(<span class="source_keyword">None</span>); <span class="source_comment">//update AI
</span><a name="697"></a>
<a name="698"></a>            	<span class="source_comment">//now respawn all the players
</span><a name="699"></a>            	<span class="source_keyword">for</span> (<span class="source_type">C</span> = <span class="source_type">Level</span>.ControllerList; <span class="source_type">C</span> != <span class="source_keyword">None</span>; <span class="source_type">C</span> = <span class="source_type">C</span>.nextController)
<a name="700"></a>            		<span class="source_keyword">if</span> (<span class="source_type">C</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> != <span class="source_keyword">None</span> && !<span class="source_type">C</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.bOnlySpectator)
<a name="701"></a>	            		RestartPlayer(<span class="source_type">C</span>);
<a name="702"></a>
<a name="703"></a>            	<span class="source_comment">//reset timelimit
</span><a name="704"></a>            	RemainingTime = <span class="source_int">60</span> * TimeLimit;
<a name="705"></a>            	<span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.RemainingMinute = RemainingTime;
<a name="706"></a>
<a name="707"></a>                ResetCountDown = <span class="source_int">0</span>;
<a name="708"></a>           }
<a name="709"></a>        }
<a name="710"></a>    }
<a name="711"></a>}
<a name="712"></a>
<a name="713"></a><span class="source_keyword">function</span> MainCoreDestroyed(<span class="source_keyword">byte</span> <span class="source_type">T</span>)
<a name="714"></a>{
<a name="715"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">C</span>;
<a name="716"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">PC</span>;
<a name="717"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">Score</span>;
<a name="718"></a>
<a name="719"></a>    <span class="source_keyword">if</span> (bOverTime)
<a name="720"></a>    	<span class="source_type">Score</span> = <span class="source_int">1</span>;
<a name="721"></a>    <span class="source_keyword">else</span>
<a name="722"></a>    	<span class="source_type">Score</span> = <span class="source_int">2</span>;
<a name="723"></a>
<a name="724"></a>    <span class="source_keyword">if</span> (<span class="source_type">T</span> == <span class="source_int">1</span>)
<a name="725"></a>    {
<a name="726"></a>        BroadcastLocalizedMessage( <span class="source_keyword">class</span><span class="source_name">'ONSOnslaughtMessage'</span>, <span class="source_int">0</span>);
<a name="727"></a>        TeamScoreEvent(<span class="source_int">0</span>, <span class="source_type">Score</span>, <span class="source_string">"enemy_core_destroyed"</span>);
<a name="728"></a>        Teams[<span class="source_int">0</span>].<span class="source_type">Score</span> += <span class="source_type">Score</span>;
<a name="729"></a> 		Teams[<span class="source_int">0</span>].NetUpdateTime = <span class="source_type">Level</span>.TimeSeconds - <span class="source_int">1</span>;
<a name="730"></a>       CheckScore(PowerCores[FinalCore[<span class="source_int">1</span>]].LastDamagedBy);
<a name="731"></a>    }
<a name="732"></a>    <span class="source_keyword">else</span>
<a name="733"></a>    {
<a name="734"></a>        BroadcastLocalizedMessage( <span class="source_keyword">class</span><span class="source_name">'ONSOnslaughtMessage'</span>, <span class="source_int">1</span>);
<a name="735"></a>        TeamScoreEvent(<span class="source_int">1</span>, <span class="source_type">Score</span>, <span class="source_string">"enemy_core_destroyed"</span>);
<a name="736"></a>        Teams[<span class="source_int">1</span>].<span class="source_type">Score</span> += <span class="source_type">Score</span>;
<a name="737"></a>		Teams[<span class="source_int">1</span>].NetUpdateTime = <span class="source_type">Level</span>.TimeSeconds - <span class="source_int">1</span>;
<a name="738"></a>        CheckScore(PowerCores[FinalCore[<span class="source_int">0</span>]].LastDamagedBy);
<a name="739"></a>    }
<a name="740"></a>
<a name="741"></a>    <span class="source_comment">//round has ended
</span><a name="742"></a>    <span class="source_keyword">for</span> (<span class="source_type">C</span> = <span class="source_type">Level</span>.ControllerList; <span class="source_type">C</span> != <span class="source_keyword">None</span>; <span class="source_type">C</span> = <span class="source_type">C</span>.NextController)
<a name="743"></a>    {
<a name="744"></a>    	<span class="source_type">PC</span> = <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">C</span>);
<a name="745"></a>    	<span class="source_keyword">if</span> (<span class="source_type">PC</span> != <span class="source_keyword">None</span>)
<a name="746"></a>    	{
<a name="747"></a>    		<span class="source_type">PC</span>.ClientSetBehindView(<span class="source_keyword">true</span>);
<a name="748"></a>    		<span class="source_type">PC</span>.ClientSetViewTarget(PowerCores[FinalCore[<span class="source_type">T</span>]]);
<a name="749"></a>    		<span class="source_type">PC</span>.SetViewTarget(PowerCores[FinalCore[<span class="source_type">T</span>]]);
<a name="750"></a>    		<span class="source_keyword">if</span> (!bGameEnded)
<a name="751"></a>    			<span class="source_type">PC</span>.ClientRoundEnded();
<a name="752"></a>    	}
<a name="753"></a>    	<span class="source_keyword">if</span> (!bGameEnded)
<a name="754"></a>	    	<span class="source_type">C</span>.RoundHasEnded();
<a name="755"></a>    }
<a name="756"></a>
<a name="757"></a>    ResetCountDown = ResetTimeDelay;
<a name="758"></a>}
<a name="759"></a>
<a name="760"></a><span class="source_keyword">function</span> CheckScore(<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> Scorer)
<a name="761"></a>{
<a name="762"></a>	<span class="source_keyword">if</span> (CheckMaxLives(Scorer))
<a name="763"></a>		<span class="source_keyword">return</span>;
<a name="764"></a>
<a name="765"></a>	<span class="source_keyword">if</span> (GameRulesModifiers != <span class="source_keyword">None</span> && GameRulesModifiers.CheckScore(Scorer))
<a name="766"></a>		<span class="source_keyword">return</span>;
<a name="767"></a>
<a name="768"></a>	<span class="source_keyword">if</span> (GoalScore != <span class="source_int">0</span> && (Teams[<span class="source_int">0</span>].<span class="source_type">Score</span> &gt;= GoalScore || Teams[<span class="source_int">1</span>].<span class="source_type">Score</span> &gt;= GoalScore))
<a name="769"></a>		EndGame(Scorer,<span class="source_string">"teamscorelimit"</span>);
<a name="770"></a>}
<a name="771"></a>
<a name="772"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> CheckEndGame(<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> Winner, <span class="source_keyword">string</span> <span class="source_type">Reason</span>)
<a name="773"></a>{
<a name="774"></a>	<span class="source_keyword">if</span> (<span class="source_type">Reason</span> ~= <span class="source_string">"TimeLimit"</span>)
<a name="775"></a>	{
<a name="776"></a>		<span class="source_keyword">if</span> ( !bOverTimeBroadcast )
<a name="777"></a>		{
<a name="778"></a>			StartupStage = <span class="source_int">7</span>;
<a name="779"></a>			PlayStartupMessage();
<a name="780"></a>			bOverTimeBroadcast = <span class="source_keyword">true</span>;
<a name="781"></a>		}
<a name="782"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="783"></a>	}
<a name="784"></a>
<a name="785"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.CheckEndGame(Winner, <span class="source_type">Reason</span>);
<a name="786"></a>}
<a name="787"></a>
<a name="788"></a><span class="source_keyword">function</span> SetEndGameFocus(<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> Winner)
<a name="789"></a>{
<a name="790"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">P</span>;
<a name="791"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type"><a href="../engine/player.html" class="source">player</a></span>;
<a name="792"></a>
<a name="793"></a>	<span class="source_keyword">if</span> ( Winner != <span class="source_keyword">None</span> )
<a name="794"></a>	{
<a name="795"></a>		<span class="source_keyword">if</span> (Winner.<span class="source_type">Team</span>.TeamIndex == <span class="source_int">0</span>)
<a name="796"></a>			EndGameFocus = PowerCores[FinalCore[<span class="source_int">1</span>]];
<a name="797"></a>		<span class="source_keyword">else</span>
<a name="798"></a>			EndGameFocus = PowerCores[FinalCore[<span class="source_int">0</span>]];
<a name="799"></a>	}
<a name="800"></a>	<span class="source_keyword">if</span> ( EndGameFocus != <span class="source_keyword">None</span> )
<a name="801"></a>		EndGameFocus.bAlwaysRelevant = <span class="source_keyword">true</span>;
<a name="802"></a>
<a name="803"></a>	<span class="source_keyword">for</span> ( <span class="source_type">P</span>=<span class="source_type">Level</span>.ControllerList; <span class="source_type">P</span>!=<span class="source_keyword">None</span>; <span class="source_type">P</span>=<span class="source_type">P</span>.nextController )
<a name="804"></a>	{
<a name="805"></a>		<span class="source_type"><a href="../engine/player.html" class="source">player</a></span> = <span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">P</span>);
<a name="806"></a>		<span class="source_keyword">if</span> ( <span class="source_type"><a href="../engine/player.html" class="source">Player</a></span> != <span class="source_keyword">None</span> )
<a name="807"></a>		{
<a name="808"></a>			<span class="source_keyword">if</span> ( !<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.bOnlySpectator )
<a name="809"></a>				PlayWinMessage(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>, (<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span> == <span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.Winner));
<a name="810"></a>			<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.ClientSetBehindView(<span class="source_keyword">true</span>);
<a name="811"></a>			<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.CameraDist = <span class="source_int">10</span>;
<a name="812"></a>			<span class="source_keyword">if</span> ( EndGameFocus != <span class="source_keyword">None</span> )
<a name="813"></a>			{
<a name="814"></a>				<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.ClientSetViewTarget(EndGameFocus);
<a name="815"></a>				<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.SetViewTarget(EndGameFocus);
<a name="816"></a>			}
<a name="817"></a>			<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.ClientGameEnded();
<a name="818"></a>			<span class="source_keyword">if</span> ( CurrentGameProfile != <span class="source_keyword">None</span> )
<a name="819"></a>				CurrentGameProfile.bWonMatch = (<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span> == <span class="source_type"><a href="../engine/gamereplicationinfo.html" class="source">GameReplicationInfo</a></span>.Winner);
<a name="820"></a>		}
<a name="821"></a>		<span class="source_type">P</span>.GameHasEnded();
<a name="822"></a>	}
<a name="823"></a>}
<a name="824"></a>
<a name="825"></a><span class="source_keyword">function</span> <span class="source_type">Killed</span>(<span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> Killer, <span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">Killed</span>, <span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span> <span class="source_type">KilledPawn</span>, <span class="source_keyword">class</span>&lt;<span class="source_type"><a href="../engine/damagetype.html" class="source">DamageType</a></span>&gt; <span class="source_type"><a href="../engine/damagetype.html" class="source">damageType</a></span>)
<a name="826"></a>{
<a name="827"></a>	<span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span>(<span class="source_type">Killed</span>) != <span class="source_keyword">None</span> && <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type">Killed</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>) != <span class="source_keyword">None</span>)
<a name="828"></a>		<span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type">Killed</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>).OwnerDied();
<a name="829"></a>
<a name="830"></a>	<span class="source_keyword">Super</span>.<span class="source_type">Killed</span>(Killer, <span class="source_type">Killed</span>, <span class="source_type">KilledPawn</span>, <span class="source_type"><a href="../engine/damagetype.html" class="source">damageType</a></span>);
<a name="831"></a>}
<a name="832"></a>
<a name="833"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> CriticalPlayer(<span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">Other</span>)
<a name="834"></a>{
<a name="835"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="836"></a>
<a name="837"></a>	<span class="source_keyword">if</span> (<span class="source_type">Other</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span> == <span class="source_keyword">None</span> || <span class="source_type">Other</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> == <span class="source_keyword">None</span>)
<a name="838"></a>		<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.CriticalPlayer(<span class="source_type">Other</span>);
<a name="839"></a>
<a name="840"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; PowerCores.length; <span class="source_type">x</span>++)
<a name="841"></a>		<span class="source_keyword">if</span> ( (PowerCores[<span class="source_type">x</span>].CoreStage == <span class="source_int">0</span> || PowerCores[<span class="source_type">x</span>].CoreStage == <span class="source_int">2</span>) && PowerCores[<span class="source_type">x</span>].DefenderTeamIndex != <span class="source_type">Other</span>.GetTeamNum()
<a name="842"></a>		     && ((PowerCores[<span class="source_type">x</span>].bUnderAttack && <span class="source_type">Other</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> == PowerCores[<span class="source_type">x</span>].LastDamagedBy) || VSize(<span class="source_type">Other</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.Location - PowerCores[<span class="source_type">x</span>].Location) &lt; <span class="source_int">2000</span>) )
<a name="843"></a>			<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="844"></a>
<a name="845"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.CriticalPlayer(<span class="source_type">Other</span>);
<a name="846"></a>}
<a name="847"></a>
<a name="848"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> ValidSpawnPoint(<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">PC</span>, <span class="source_keyword">int</span> TeamIndex)
<a name="849"></a>{
<a name="850"></a>    <span class="source_keyword">return</span> (<span class="source_type">PC</span> != <span class="source_keyword">None</span> && <span class="source_type">PC</span>.DefenderTeamIndex == TeamIndex &&
<a name="851"></a>            !<span class="source_type">PC</span>.IsInState(<span class="source_name">'NeutralCore'</span>) && !<span class="source_type">PC</span>.IsInState(<span class="source_name">'Reconstruction'</span>) &&
<a name="852"></a>            (!<span class="source_type">PC</span>.bUnderAttack || <span class="source_type">PC</span>.bFinalCore));
<a name="853"></a>}
<a name="854"></a>
<a name="855"></a><span class="source_keyword">function</span> <span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span> FindPlayerStart( <span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>, <span class="source_keyword2">optional</span> <span class="source_keyword">byte</span> InTeam, <span class="source_keyword2">optional</span> <span class="source_keyword">string</span> <span class="source_type">incomingName</span> )
<a name="856"></a>{
<a name="857"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span> <span class="source_type">N</span>, BestStart;
<a name="858"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../engine/teleporter.html" class="source">Teleporter</a></span> Tel;
<a name="859"></a>    <span class="source_keyword">local</span> <span class="source_keyword">float</span> BestRating, NewRating;
<a name="860"></a>    <span class="source_keyword">local</span> <span class="source_keyword">byte</span> <span class="source_type">Team</span>, EnemyTeam;
<a name="861"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> SelectedPC;
<a name="862"></a>    <span class="source_keyword">local</span> <span class="source_keyword">float</span> CoreDistA, CoreDistB;
<a name="863"></a>    <span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="864"></a>    <span class="source_keyword">local</span> <span class="source_type"><a href="../unrealgame/bot.html" class="source">Bot</a></span> <span class="source_type">B</span>;
<a name="865"></a>
<a name="866"></a>    <span class="source_keyword">if</span> ( GameRulesModifiers != <span class="source_keyword">None</span> )
<a name="867"></a>    {
<a name="868"></a>        <span class="source_type">N</span> = GameRulesModifiers.FindPlayerStart(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>,InTeam,<span class="source_type">incomingName</span>);
<a name="869"></a>        <span class="source_keyword">if</span> ( <span class="source_type">N</span> != <span class="source_keyword">None</span> )
<a name="870"></a>            <span class="source_keyword">return</span> <span class="source_type">N</span>;
<a name="871"></a>    }
<a name="872"></a>
<a name="873"></a>    <span class="source_comment">// if incoming start is specified, then just use it
</span><a name="874"></a>    <span class="source_keyword">if</span>( <span class="source_type">incomingName</span>!=<span class="source_string">""</span> )
<a name="875"></a>        <span class="source_keyword">foreach</span> AllActors( <span class="source_keyword">class</span> <span class="source_name">'Teleporter'</span>, Tel )
<a name="876"></a>            <span class="source_keyword">if</span>( <span class="source_keyword">string</span>(Tel.Tag)~=<span class="source_type">incomingName</span> )
<a name="877"></a>                <span class="source_keyword">return</span> Tel;
<a name="878"></a>
<a name="879"></a>    <span class="source_comment">// use InTeam if player doesn't have a team yet
</span><a name="880"></a>    <span class="source_keyword">if</span> ( (<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span> != <span class="source_keyword">None</span>) && (<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> != <span class="source_keyword">None</span>) )
<a name="881"></a>    {
<a name="882"></a>        <span class="source_keyword">if</span> ( <span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span> != <span class="source_keyword">None</span> )
<a name="883"></a>            <span class="source_type">Team</span> = <span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>.<span class="source_type">Team</span>.TeamIndex;
<a name="884"></a>        <span class="source_keyword">else</span>
<a name="885"></a>            <span class="source_type">Team</span> = InTeam;
<a name="886"></a>        <span class="source_comment">//Use the powercore the player selected (if it's valid)
</span><a name="887"></a>		<span class="source_keyword">if</span> ( <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>) != <span class="source_keyword">None</span> )
<a name="888"></a>        {
<a name="889"></a>    		SelectedPC = <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>).TemporaryStartCore;
<a name="890"></a>    		<span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>).TemporaryStartCore = <span class="source_keyword">None</span>;
<a name="891"></a>    		<span class="source_keyword">if</span> (SelectedPC != <span class="source_keyword">None</span> && !ValidSpawnPoint(SelectedPC, <span class="source_type">Team</span>))
<a name="892"></a>    			SelectedPC = <span class="source_keyword">None</span>;
<a name="893"></a>    		<span class="source_keyword">if</span> (SelectedPC == <span class="source_keyword">None</span>)
<a name="894"></a>    		{
<a name="895"></a>	        	SelectedPC = <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>).StartCore;
<a name="896"></a>		        <span class="source_keyword">if</span> (!ValidSpawnPoint(SelectedPC, <span class="source_type">Team</span>))
<a name="897"></a>                    SelectedPC = <span class="source_keyword">None</span>;
<a name="898"></a>	        }
<a name="899"></a>        }
<a name="900"></a>        <span class="source_keyword">if</span> ( SelectedPC == <span class="source_keyword">None</span> )
<a name="901"></a>        {
<a name="902"></a>	        <span class="source_comment">//Bots always want to go to their SquadObjective
</span><a name="903"></a>	        <span class="source_type">B</span> = <span class="source_type"><a href="../unrealgame/bot.html" class="source">Bot</a></span>(<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>);
<a name="904"></a>        	<span class="source_keyword">if</span> (<span class="source_type">B</span> != <span class="source_keyword">None</span> && <span class="source_type">B</span>.Squad != <span class="source_keyword">None</span> && <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>(<span class="source_type">B</span>.Squad.SquadObjective) != <span class="source_keyword">None</span> && ValidSpawnPoint(<span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>(<span class="source_type">B</span>.Squad.SquadObjective), <span class="source_type">Team</span>))
<a name="905"></a>        		SelectedPC = <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span>(<span class="source_type">B</span>.Squad.SquadObjective);
<a name="906"></a>        }
<a name="907"></a>    }
<a name="908"></a>    <span class="source_keyword">else</span>
<a name="909"></a>        <span class="source_type">Team</span> = InTeam;
<a name="910"></a>
<a name="911"></a>    <span class="source_keyword">if</span> (SelectedPC == <span class="source_keyword">None</span>)
<a name="912"></a>    {
<a name="913"></a>    	<span class="source_keyword">if</span> (PowerCores[FinalCore[<span class="source_type">Team</span>]].PoweredBy(<span class="source_int">1</span> - <span class="source_type">Team</span>))
<a name="914"></a>    		SelectedPC = PowerCores[FinalCore[<span class="source_type">Team</span>]];
<a name="915"></a>
<a name="916"></a>    	<span class="source_keyword">if</span> (SelectedPC == <span class="source_keyword">None</span>)
<a name="917"></a>    	{
<a name="918"></a>	        <span class="source_comment">// Find the Closest Controlled Node(s) to Enemy PowerCore.
</span><a name="919"></a>	        EnemyTeam = abs(<span class="source_type">Team</span> - <span class="source_int">1</span>);
<a name="920"></a>	        BestRating = <span class="source_int">255</span>;
<a name="921"></a>	        <span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerCores.Length; <span class="source_type">i</span>++)
<a name="922"></a>	        {
<a name="923"></a>	            <span class="source_keyword">if</span> (ValidSpawnPoint(PowerCores[<span class="source_type">i</span>], <span class="source_type">Team</span>))
<a name="924"></a>	            {
<a name="925"></a>	                NewRating = PowerCores[<span class="source_type">i</span>].FinalCoreDistance[EnemyTeam];
<a name="926"></a>	                <span class="source_keyword">if</span> ( NewRating &lt; BestRating )
<a name="927"></a>	                {
<a name="928"></a>	                    BestRating = NewRating;
<a name="929"></a>	                    SelectedPC = PowerCores[<span class="source_type">i</span>];
<a name="930"></a>	                }
<a name="931"></a>	                <span class="source_keyword">else</span> <span class="source_keyword">if</span> ( NewRating == BestRating ) <span class="source_comment">// If we have two nodes at equal link distance, we check geometric distance
</span><a name="932"></a>	                {
<a name="933"></a>                        CoreDistA = VSize(PowerCores[FinalCore[EnemyTeam]].Location - PowerCores[<span class="source_type">i</span>].Location);
<a name="934"></a>                        CoreDistB = VSize(PowerCores[FinalCore[EnemyTeam]].Location - SelectedPC.Location);
<a name="935"></a>                        <span class="source_keyword">if</span> (CoreDistA &lt; CoreDistB)
<a name="936"></a>                            SelectedPC = PowerCores[<span class="source_type">i</span>];
<a name="937"></a>                    }
<a name="938"></a>	            }
<a name="939"></a>	        }
<a name="940"></a>
<a name="941"></a>	        <span class="source_comment">// If no valid power node found, set to power core.
</span><a name="942"></a>            <span class="source_keyword">if</span> (SelectedPC == <span class="source_keyword">None</span>)
<a name="943"></a>		        SelectedPC = PowerCores[FinalCore[<span class="source_type">Team</span>]];
<a name="944"></a>        }
<a name="945"></a>    }
<a name="946"></a>
<a name="947"></a>    <span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; SelectedPC.CloseActors.length; <span class="source_type">i</span>++)
<a name="948"></a>        <span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]) != <span class="source_keyword">None</span>)
<a name="949"></a>        {
<a name="950"></a>	        NewRating = RatePlayerStart(<span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]),<span class="source_type">Team</span>,<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>);
<a name="951"></a>        	<span class="source_keyword">if</span> ( NewRating &gt; BestRating )
<a name="952"></a>	        {
<a name="953"></a>        	    BestRating = NewRating;
<a name="954"></a>	            BestStart = <span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]);
<a name="955"></a>        	}
<a name="956"></a>	}
<a name="957"></a>
<a name="958"></a>    <span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playerstart.html" class="source">PlayerStart</a></span>(BestStart) == <span class="source_keyword">None</span> && SelectedPC != PowerCores[FinalCore[<span class="source_type">Team</span>]])
<a name="959"></a>    {
<a name="960"></a>    	<span class="source_comment">//couldn't find a start at the requested node, so try powercore
</span><a name="961"></a>    	SelectedPC = PowerCores[FinalCore[<span class="source_type">Team</span>]];
<a name="962"></a>    	<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; SelectedPC.CloseActors.length; <span class="source_type">i</span>++)
<a name="963"></a>	        <span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]) != <span class="source_keyword">None</span>)
<a name="964"></a>	        {
<a name="965"></a>		        NewRating = RatePlayerStart(<span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]),<span class="source_type">Team</span>,<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>);
<a name="966"></a>	        	<span class="source_keyword">if</span> ( NewRating &gt; BestRating )
<a name="967"></a>		        {
<a name="968"></a>	        	    BestRating = NewRating;
<a name="969"></a>		            BestStart = <span class="source_type"><a href="../engine/navigationpoint.html" class="source">NavigationPoint</a></span>(SelectedPC.CloseActors[<span class="source_type">i</span>]);
<a name="970"></a>	        	}
<a name="971"></a>		}
<a name="972"></a>    }
<a name="973"></a>
<a name="974"></a>    <span class="source_keyword">if</span> (<span class="source_type"><a href="../engine/playerstart.html" class="source">PlayerStart</a></span>(BestStart) == <span class="source_keyword">None</span>)
<a name="975"></a>    {
<a name="976"></a>        log(<span class="source_string">"Warning - PATHS NOT DEFINED or NO PLAYERSTART with positive rating"</span>);
<a name="977"></a>	BestRating = -<span class="source_int">100000000</span>;
<a name="978"></a>        <span class="source_keyword">ForEach</span> AllActors( <span class="source_keyword">class</span> <span class="source_name">'NavigationPoint'</span>, <span class="source_type">N</span> )
<a name="979"></a>        {
<a name="980"></a>            NewRating = RatePlayerStart(<span class="source_type">N</span>,<span class="source_int">0</span>,<span class="source_type"><a href="../engine/player.html" class="source">Player</a></span>);
<a name="981"></a>            <span class="source_keyword">if</span> ( <span class="source_type"><a href="../engine/inventoryspot.html" class="source">InventorySpot</a></span>(<span class="source_type">N</span>) != <span class="source_keyword">None</span> )
<a name="982"></a>				NewRating -= <span class="source_int">50</span>;
<a name="983"></a>			NewRating += <span class="source_int">20</span> * FRand();
<a name="984"></a>            <span class="source_keyword">if</span> ( NewRating &gt; BestRating )
<a name="985"></a>            {
<a name="986"></a>                BestRating = NewRating;
<a name="987"></a>                BestStart = <span class="source_type">N</span>;
<a name="988"></a>            }
<a name="989"></a>        }
<a name="990"></a>    }
<a name="991"></a>
<a name="992"></a>    <span class="source_keyword">return</span> BestStart;
<a name="993"></a>}
<a name="994"></a>
<a name="995"></a><span class="source_keyword">function</span> ShowPathTo(<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">P</span>, <span class="source_keyword">int</span> <span class="source_type">TeamNum</span>)
<a name="996"></a>{
<a name="997"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">x</span>;
<a name="998"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> Best;
<a name="999"></a>	<span class="source_keyword">local</span> <span class="source_keyword">float</span> BestDist;
<a name="1000"></a>	<span class="source_keyword">local</span> <span class="source_keyword">class</span>&lt;<span class="source_type"><a href="../unrealgame/willowwhisp.html" class="source">WillowWhisp</a></span>&gt;	WWclass;
<a name="1001"></a>
<a name="1002"></a>	<span class="source_keyword">for</span> (<span class="source_type">x</span> = <span class="source_int">0</span>; <span class="source_type">x</span> &lt; PowerCores.Length; <span class="source_type">x</span>++)
<a name="1003"></a>		<span class="source_keyword">if</span> ( (PowerCores[<span class="source_type">x</span>].CoreStage != <span class="source_int">0</span> || PowerCores[<span class="source_type">x</span>].DefenderTeamIndex != <span class="source_type">TeamNum</span>) && PowerCores[<span class="source_type">x</span>].PoweredBy(<span class="source_type">TeamNum</span>)
<a name="1004"></a>		     && (Best == <span class="source_keyword">None</span> || VSize(<span class="source_type">P</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.Location - PowerCores[<span class="source_type">x</span>].Location) &lt; BestDist) )
<a name="1005"></a>		{
<a name="1006"></a>			Best = PowerCores[<span class="source_type">x</span>];
<a name="1007"></a>			BestDist = VSize(<span class="source_type">P</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.Location - PowerCores[<span class="source_type">x</span>].Location);
<a name="1008"></a>		}
<a name="1009"></a>
<a name="1010"></a>	<span class="source_keyword">if</span> (Best != <span class="source_keyword">None</span> && <span class="source_type">P</span>.FindPathToward(Best, <span class="source_keyword">false</span>) != <span class="source_keyword">None</span>)
<a name="1011"></a>	{
<a name="1012"></a>		WWclass = <span class="source_keyword">class</span>&lt;<span class="source_type"><a href="../unrealgame/willowwhisp.html" class="source">WillowWhisp</a></span>&gt;(DynamicLoadObject(PathWhisps[<span class="source_type">TeamNum</span>], <span class="source_keyword">class</span><span class="source_name">'Class'</span>));
<a name="1013"></a>		Spawn(WWclass, <span class="source_type">P</span>,, <span class="source_type">P</span>.<span class="source_type"><a href="../engine/pawn.html" class="source">Pawn</a></span>.Location);
<a name="1014"></a>	}
<a name="1015"></a>}
<a name="1016"></a>
<a name="1017"></a><span class="source_keyword">function</span> GetServerInfo(<span class="source_keyword2">out</span> <span class="source_type"><a href="../engine/gameinfo.html#ServerResponseLine" class="source">ServerResponseLine</a></span> <span class="source_type">ServerState</span>)
<a name="1018"></a>{
<a name="1019"></a>	<span class="source_keyword">Super</span>.GetServerInfo(<span class="source_type">ServerState</span>);
<a name="1020"></a>
<a name="1021"></a>	<span class="source_keyword">if</span> (!bCurrentSetupIsOfficial)
<a name="1022"></a>		<span class="source_type">ServerState</span>.<span class="source_type">MapName</span> $= <span class="source_string">"*"</span>;
<a name="1023"></a>}
<a name="1024"></a>
<a name="1025"></a><span class="source_keyword">function</span> GetServerDetails(<span class="source_keyword2">out</span> <span class="source_type"><a href="../engine/gameinfo.html#ServerResponseLine" class="source">ServerResponseLine</a></span> <span class="source_type">ServerState</span>)
<a name="1026"></a>{
<a name="1027"></a>	<span class="source_keyword">Super</span>.GetServerDetails(<span class="source_type">ServerState</span>);
<a name="1028"></a>
<a name="1029"></a>	AddServerDetail( <span class="source_type">ServerState</span>, <span class="source_string">"LinkSetup"</span>, CurrentSetupName );
<a name="1030"></a>}
<a name="1031"></a>
<a name="1032"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> ChangeTeam(<span class="source_type"><a href="../engine/controller.html" class="source">Controller</a></span> <span class="source_type">Other</span>, <span class="source_keyword">int</span> num, <span class="source_keyword">bool</span> bNewTeam)
<a name="1033"></a>{
<a name="1034"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1035"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span> PRI;
<a name="1036"></a>
<a name="1037"></a>	<span class="source_keyword">if</span> (<span class="source_keyword">Super</span>.ChangeTeam(<span class="source_type">Other</span>, num, bNewTeam))
<a name="1038"></a>	{
<a name="1039"></a>		<span class="source_keyword">if</span> (<span class="source_type">Other</span> == <span class="source_type">Level</span>.GetLocalPlayerController())
<a name="1040"></a>		{
<a name="1041"></a>			<span class="source_comment">//Update client side effects on powercores to reflect which ones the player can go after changing teams
</span><a name="1042"></a>			<span class="source_keyword">for</span> (<span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; PowerCores.length; <span class="source_type">i</span>++)
<a name="1043"></a>				PowerCores[<span class="source_type">i</span>].CheckShield();
<a name="1044"></a>		}
<a name="1045"></a>
<a name="1046"></a>		PRI = <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type">Other</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>);
<a name="1047"></a>		<span class="source_keyword">if</span> (PRI != <span class="source_keyword">None</span>)
<a name="1048"></a>		{
<a name="1049"></a>			PRI.StartCore = <span class="source_keyword">None</span>;
<a name="1050"></a>			PRI.TemporaryStartCore = <span class="source_keyword">None</span>;
<a name="1051"></a>		}
<a name="1052"></a>
<a name="1053"></a>		<span class="source_keyword">return</span> <span class="source_keyword">true</span>;
<a name="1054"></a>	}
<a name="1055"></a>
<a name="1056"></a>	<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="1057"></a>}
<a name="1058"></a>
<a name="1059"></a><span class="source_keyword">function</span> PlayStartupMessage()
<a name="1060"></a>{
<a name="1061"></a>	<span class="source_keyword">Super</span>.PlayStartupMessage();
<a name="1062"></a>
<a name="1063"></a>	<span class="source_keyword">if</span> (StartupStage == <span class="source_int">7</span> && OvertimeCoreDrainPerSec &gt; <span class="source_int">0</span>)
<a name="1064"></a>		BroadcastLocalizedMessage(<span class="source_keyword">class</span><span class="source_name">'ONSOnslaughtMessage'</span>, <span class="source_int">29</span>);
<a name="1065"></a>}
<a name="1066"></a>
<a name="1067"></a><span class="source_keyword">function</span> ScoreObjective(<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span> Scorer, <span class="source_keyword">float</span> <span class="source_type">Score</span>)
<a name="1068"></a>{
<a name="1069"></a>	<span class="source_keyword">if</span> (Scorer != <span class="source_keyword">None</span>)
<a name="1070"></a>		Scorer.<span class="source_type">Score</span> += <span class="source_type">Score</span>;
<a name="1071"></a>
<a name="1072"></a>	<span class="source_keyword">if</span> (GameRulesModifiers != <span class="source_keyword">None</span>)
<a name="1073"></a>		GameRulesModifiers.ScoreObjective(Scorer,<span class="source_type">Score</span>);
<a name="1074"></a>}
<a name="1075"></a>
<a name="1076"></a><span class="source_keyword2">static</span> <span class="source_keyword">event</span> <span class="source_keyword">bool</span> AcceptPlayInfoProperty(<span class="source_keyword">string</span> PropertyName)
<a name="1077"></a>{
<a name="1078"></a>	<span class="source_keyword">if</span> ( InStr(PropertyName, <span class="source_string">"bAllowTrans"</span>) != -<span class="source_int">1</span> )
<a name="1079"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="1080"></a>
<a name="1081"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.AcceptPlayInfoProperty(PropertyName);
<a name="1082"></a>}
<a name="1083"></a>
<a name="1084"></a><span class="source_keyword2">static</span> <span class="source_keyword">function</span> FillPlayInfo(<span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span> <span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span>)
<a name="1085"></a>{
<a name="1086"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1087"></a>
<a name="1088"></a>	<span class="source_keyword">Super</span>.FillPlayInfo(<span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span>);  <span class="source_comment">// Always begin with calling parent
</span><a name="1089"></a>
<a name="1090"></a>	<span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span>.AddSetting(default.GameGroup, <span class="source_string">"OvertimeCoreDrainPerSec"</span>, default.ONSPropsDisplayText[<span class="source_type">i</span>++], <span class="source_int">40</span>, <span class="source_int">1</span>, <span class="source_string">"Text"</span>, <span class="source_string">"2;0:99"</span>);
<a name="1091"></a>	<span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span>.AddSetting(default.GameGroup, <span class="source_string">"bRandSetupAfterReset"</span>,    default.ONSPropsDisplayText[<span class="source_type">i</span>++], <span class="source_int">0</span>,  <span class="source_int">1</span>, <span class="source_string">"Check"</span>,        ,,     , <span class="source_keyword">true</span>);
<a name="1092"></a>	<span class="source_type"><a href="../engine/playinfo.html" class="source">PlayInfo</a></span>.AddSetting(default.GameGroup, <span class="source_string">"bSwapSidesAfterReset"</span>,    default.ONSPropsDisplayText[<span class="source_type">i</span>++], <span class="source_int">0</span>,  <span class="source_int">1</span>, <span class="source_string">"Check"</span>,        ,,     , <span class="source_keyword">true</span>);
<a name="1093"></a>}
<a name="1094"></a>
<a name="1095"></a><span class="source_keyword2">static</span> <span class="source_keyword">event</span> <span class="source_keyword">string</span> GetDescriptionText(<span class="source_keyword">string</span> <span class="source_type">PropName</span>)
<a name="1096"></a>{
<a name="1097"></a>	<span class="source_keyword">switch</span> (<span class="source_type">PropName</span>)
<a name="1098"></a>	{
<a name="1099"></a>		<span class="source_keyword">case</span> <span class="source_string">"OvertimeCoreDrainPerSec"</span>:	<span class="source_keyword">return</span> default.ONSPropDescText[<span class="source_int">0</span>];
<a name="1100"></a>		<span class="source_keyword">case</span> <span class="source_string">"bRandSetupAfterReset"</span>:	<span class="source_keyword">return</span> default.ONSPropDescText[<span class="source_int">1</span>];
<a name="1101"></a>		<span class="source_keyword">case</span> <span class="source_string">"bSwapSidesAfterReset"</span>:	<span class="source_keyword">return</span> default.ONSPropDescText[<span class="source_int">2</span>];
<a name="1102"></a>	}
<a name="1103"></a>
<a name="1104"></a>	<span class="source_keyword">return</span> <span class="source_keyword">Super</span>.GetDescriptionText(<span class="source_type">PropName</span>);
<a name="1105"></a>}
<a name="1106"></a>
<a name="1107"></a><span class="source_keyword2">static</span> <span class="source_keyword">function</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">string</span>&gt; GetAllLoadHints(<span class="source_keyword2">optional</span> <span class="source_keyword">bool</span> bThisClassOnly)
<a name="1108"></a>{
<a name="1109"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1110"></a>	<span class="source_keyword">local</span> <span class="source_keyword">array</span>&lt;<span class="source_keyword">string</span>&gt; Hints;
<a name="1111"></a>
<a name="1112"></a>	<span class="source_keyword">if</span> ( !bThisClassOnly || default.ONSHints.Length == <span class="source_int">0</span> )
<a name="1113"></a>		Hints = <span class="source_keyword">Super</span>.GetAllLoadHints();
<a name="1114"></a>
<a name="1115"></a>	<span class="source_keyword">for</span> ( <span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; default.ONSHints.Length; <span class="source_type">i</span>++ )
<a name="1116"></a>		Hints[Hints.Length] = default.ONSHints[<span class="source_type">i</span>];
<a name="1117"></a>
<a name="1118"></a>	<span class="source_keyword">return</span> Hints;
<a name="1119"></a>}
<a name="1120"></a>
<a name="1121"></a><span class="source_keyword">event</span> Destroyed()
<a name="1122"></a>{
<a name="1123"></a>	CustomPowerLinkSetups.length = <span class="source_int">0</span>;
<a name="1124"></a>
<a name="1125"></a>	<span class="source_keyword">Super</span>.Destroyed();
<a name="1126"></a>}
<a name="1127"></a>
<a name="1128"></a><span class="source_keyword">function</span> SetupLinks()
<a name="1129"></a>{
<a name="1130"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">Core</span>;
<a name="1131"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1132"></a>
<a name="1133"></a>	<span class="source_keyword">if</span> ( PowerCores.Length == <span class="source_int">0</span> )
<a name="1134"></a>		<span class="source_keyword">return</span>;
<a name="1135"></a>
<a name="1136"></a>	<span class="source_type">Core</span> = PowerCores[<span class="source_int">0</span>];
<a name="1137"></a>	do
<a name="1138"></a>	{
<a name="1139"></a>		<span class="source_keyword">for</span> ( <span class="source_type">i</span> = <span class="source_int">0</span>; <span class="source_type">i</span> &lt; <span class="source_type">Core</span>.PowerLinks.Length; <span class="source_type">i</span>++ )
<a name="1140"></a>			AddLink(<span class="source_type">Core</span>, <span class="source_type">Core</span>.PowerLinks[<span class="source_type">i</span>]);
<a name="1141"></a>
<a name="1142"></a>		<span class="source_type">Core</span> = <span class="source_type">Core</span>.NextCore;
<a name="1143"></a>	} until ( <span class="source_type">Core</span> == <span class="source_keyword">None</span> || <span class="source_type">Core</span> == PowerCores[<span class="source_int">0</span>] );
<a name="1144"></a>}
<a name="1145"></a>
<a name="1146"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> AddLink( <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">A</span>, <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">B</span> )
<a name="1147"></a>{
<a name="1148"></a>	<span class="source_keyword">local</span> <span class="source_type"><a href="../onslaught/powerlink.html" class="source">PowerLink</a></span> Link;
<a name="1149"></a>
<a name="1150"></a>	<span class="source_keyword">if</span> ( HasLink(<span class="source_type">A</span>,<span class="source_type">B</span>) )
<a name="1151"></a>		<span class="source_keyword">return</span> <span class="source_keyword">false</span>;
<a name="1152"></a>
<a name="1153"></a>	Link = Spawn(<span class="source_keyword">class</span><span class="source_name">'PowerLink'</span>);
<a name="1154"></a>	Link.SetNodes(<span class="source_type">A</span>,<span class="source_type">B</span>);
<a name="1155"></a>
<a name="1156"></a><span class="source_comment">//	log(Name@"AddLink Link:"$Link.Name@"A:"$A.Name@"B:"$B.Name);
</span><a name="1157"></a>	PowerLinks[PowerLinks.Length] = Link;
<a name="1158"></a><span class="source_comment">//	A.AddPowerLink(B);
</span><a name="1159"></a><span class="source_comment">//	A.PowerCoreReset();
</span><a name="1160"></a><span class="source_comment">//	B.PowerCoreReset();
</span><a name="1161"></a>	<span class="source_keyword">return</span> <span class="source_keyword">True</span>;
<a name="1162"></a>}
<a name="1163"></a>
<a name="1164"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> RemoveLink( <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">A</span>, <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">B</span> )
<a name="1165"></a>{
<a name="1166"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1167"></a>
<a name="1168"></a>	<span class="source_keyword">for</span> ( <span class="source_type">i</span> = PowerLinks.Length - <span class="source_int">1</span>; <span class="source_type">i</span> &gt;= <span class="source_int">0</span>; <span class="source_type">i</span>-- )
<a name="1169"></a>	{
<a name="1170"></a>		<span class="source_keyword">if</span> ( PowerLinks[<span class="source_type">i</span>] == <span class="source_keyword">None</span> )
<a name="1171"></a>		{
<a name="1172"></a>			PowerLinks.Remove(<span class="source_type">i</span>,<span class="source_int">1</span>);
<a name="1173"></a>			continue;
<a name="1174"></a>		}
<a name="1175"></a>
<a name="1176"></a>		<span class="source_keyword">if</span> ( PowerLinks[<span class="source_type">i</span>].HasNodes(<span class="source_type">A</span>,<span class="source_type">B</span>) )
<a name="1177"></a>		{
<a name="1178"></a><span class="source_comment">//			A.RemovePowerLink(B);
</span><a name="1179"></a>
<a name="1180"></a><span class="source_comment">//			A.PowerCoreReset();
</span><a name="1181"></a><span class="source_comment">//			B.PowerCoreReset();
</span><a name="1182"></a>			PowerLinks[<span class="source_type">i</span>].Destroy();
<a name="1183"></a>			PowerLinks.Remove(<span class="source_type">i</span>,<span class="source_int">1</span>);
<a name="1184"></a>			<span class="source_keyword">return</span> <span class="source_keyword">True</span>;
<a name="1185"></a>		}
<a name="1186"></a>	}
<a name="1187"></a>
<a name="1188"></a>	<span class="source_keyword">return</span> <span class="source_keyword">False</span>;
<a name="1189"></a>}
<a name="1190"></a>
<a name="1191"></a><span class="source_keyword">function</span> <span class="source_keyword">bool</span> HasLink( <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">A</span>, <span class="source_type"><a href="../onslaught/onspowercore.html" class="source">ONSPowerCore</a></span> <span class="source_type">B</span> )
<a name="1192"></a>{
<a name="1193"></a>	<span class="source_keyword">local</span> <span class="source_keyword">int</span> <span class="source_type">i</span>;
<a name="1194"></a>
<a name="1195"></a>	<span class="source_keyword">for</span> ( <span class="source_type">i</span> = PowerLinks.Length - <span class="source_int">1</span>; <span class="source_type">i</span> &gt;= <span class="source_int">0</span>; <span class="source_type">i</span>-- )
<a name="1196"></a>	{
<a name="1197"></a>		<span class="source_keyword">if</span> ( PowerLinks[<span class="source_type">i</span>] == <span class="source_keyword">None</span> )
<a name="1198"></a>		{
<a name="1199"></a>			PowerLinks.Remove(<span class="source_type">i</span>,<span class="source_int">1</span>);
<a name="1200"></a>			continue;
<a name="1201"></a>		}
<a name="1202"></a>
<a name="1203"></a>		<span class="source_keyword">if</span> ( PowerLinks[<span class="source_type">i</span>].HasNodes(<span class="source_type">A</span>,<span class="source_type">B</span>) )
<a name="1204"></a>			<span class="source_keyword">return</span> <span class="source_keyword">True</span>;
<a name="1205"></a>	}
<a name="1206"></a>
<a name="1207"></a>	<span class="source_keyword">return</span> <span class="source_keyword">False</span>;
<a name="1208"></a>}
<a name="1209"></a>
<a name="1210"></a><span class="source_keyword">event</span> PostLogin(<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">NewPlayer</span>)
<a name="1211"></a>{
<a name="1212"></a>	<span class="source_keyword">Super</span>.PostLogin(<span class="source_type">NewPlayer</span>);
<a name="1213"></a>
<a name="1214"></a>	<span class="source_keyword">if</span> ( <span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type">NewPlayer</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>) != <span class="source_keyword">None</span> )
<a name="1215"></a>		<span class="source_type"><a href="../onslaught/onsplayerreplicationinfo.html" class="source">ONSPlayerReplicationInfo</a></span>(<span class="source_type">NewPlayer</span>.<span class="source_type"><a href="../engine/playerreplicationinfo.html" class="source">PlayerReplicationInfo</a></span>).ClientPrepareToReceivePowerLinks();
<a name="1216"></a>}
<a name="1217"></a>
<a name="1218"></a><span class="source_keyword">function</span> DeadUse(<span class="source_type"><a href="../engine/playercontroller.html" class="source">PlayerController</a></span> <span class="source_type">PC</span>)
<a name="1219"></a>{
<a name="1220"></a>	<span class="source_keyword">Super</span>.DeadUse(<span class="source_type">PC</span>);
<a name="1221"></a>	<span class="source_type">PC</span>.ShowMenu();
<a name="1222"></a>}
<a name="1223"></a>
<a name="1224"></a><span class="source_keyword">defaultproperties</span>
<a name="1225"></a>{
<a name="1226"></a>     OvertimeCoreDrainPerSec=<span class="source_int">20</span>
<a name="1227"></a>     bSwapSidesAfterReset=<span class="source_keyword">True</span>
<a name="1228"></a>     ONSPropsDisplayText(<span class="source_int">0</span>)=<span class="source_string">"Core Drain in Overtime"</span>
<a name="1229"></a>     ONSPropsDisplayText(<span class="source_int">1</span>)=<span class="source_string">"Random Link Setup After Reset"</span>
<a name="1230"></a>     ONSPropsDisplayText(<span class="source_int">2</span>)=<span class="source_string">"Teams Swap Sides After Reset"</span>
<a name="1231"></a>     ONSPropDescText(<span class="source_int">0</span>)=<span class="source_string">"In overtime, PowerCores lose a maximum of this much health every second."</span>
<a name="1232"></a>     ONSPropDescText(<span class="source_int">1</span>)=<span class="source_string">"After a reset, a new link setup will be chosen at random."</span>
<a name="1233"></a>     ONSPropDescText(<span class="source_int">2</span>)=<span class="source_string">"After a reset, teams will switch sides so they are defending the PowerCore they were previously attacking."</span>
<a name="1234"></a>     ONSHints(<span class="source_int">0</span>)=<span class="source_string">"If you receive a missile lock warning, try to get out of sight quickly!"</span>
<a name="1235"></a>     ONSHints(<span class="source_int">1</span>)=<span class="source_string">"The Raptor's missiles will automatically lock onto Mantas and other Raptors."</span>
<a name="1236"></a>     ONSHints(<span class="source_int">2</span>)=<span class="source_string">"In the Raptor press %JUMP% to fly higher and %DUCK% to fly lower."</span>
<a name="1237"></a>     ONSHints(<span class="source_int">3</span>)=<span class="source_string">"The Manta can rapidly descend to smash your enemies by pressing %DUCK% or %ALTFIRE%."</span>
<a name="1238"></a>     ONSHints(<span class="source_int">4</span>)=<span class="source_string">"Press %JUMP% to perform a 180 spin out in the Hellbender or Scorpion."</span>
<a name="1239"></a>     ONSHints(<span class="source_int">5</span>)=<span class="source_string">"The Manta is the only vehicle that has the ability to jump."</span>
<a name="1240"></a>     ONSHints(<span class="source_int">6</span>)=<span class="source_string">"When deployed, the Leviathan is highly vulnerable to air attacks."</span>
<a name="1241"></a>     ONSHints(<span class="source_int">7</span>)=<span class="source_string">"You can heal a friendly vehicle with the link gun alt-fire."</span>
<a name="1242"></a>     ONSHints(<span class="source_int">8</span>)=<span class="source_string">"You can heal a friendly PowerNode with the link gun alt-fire."</span>
<a name="1243"></a>     ONSHints(<span class="source_int">9</span>)=<span class="source_string">"It is impossible to heal the final PowerCore, so defend it at all costs!"</span>
<a name="1244"></a>     ONSHints(<span class="source_int">10</span>)=<span class="source_string">"Press %TOGGLERADARMAP% to toggle the radar map on and off."</span>
<a name="1245"></a>     ONSHints(<span class="source_int">11</span>)=<span class="source_string">"You can be hurt or killed by vehicles exploding near you."</span>
<a name="1246"></a>     ONSHints(<span class="source_int">12</span>)=<span class="source_string">"Enemy Spider Mines can be destroyed, but some weapons are better against them than others."</span>
<a name="1247"></a>     ONSHints(<span class="source_int">13</span>)=<span class="source_string">"Pressing %USE% on a PowerNode allows you to teleport to any PowerNode your team controls."</span>
<a name="1248"></a>     ONSHints(<span class="source_int">14</span>)=<span class="source_string">"You won't be able to spawn at a PowerNode that is under attack, even if your team controls it."</span>
<a name="1249"></a>     ONSHints(<span class="source_int">15</span>)=<span class="source_string">"If you die, any Spider Mines or Grenades you fired will explode."</span>
<a name="1250"></a>     ONSHints(<span class="source_int">16</span>)=<span class="source_string">"Press %VOICETALK% to voice chat with your team."</span>
<a name="1251"></a>     ONSHints(<span class="source_int">17</span>)=<span class="source_string">"%BASEPATH 0% will show the way to the nearest PowerNode or PowerCore the Red Team can attack, while %BASEPATH 1% will do the same for the Blue Team."</span>
<a name="1252"></a>     ONSHints(<span class="source_int">18</span>)=<span class="source_string">"Press %TOGGLEBEHINDVIEW% to switch between 1st and 3rd person mode in vehicles."</span>
<a name="1253"></a>     ONSHints(<span class="source_int">19</span>)=<span class="source_string">"AVRiL rockets will home into an occupied enemy vehicle as long as you keep your crosshair on it."</span>
<a name="1254"></a>     ONSHints(<span class="source_int">20</span>)=<span class="source_string">"When you find a target with the AVRiL, press alt-fire to zoom and lock your view to that target."</span>
<a name="1255"></a>     ONSHints(<span class="source_int">21</span>)=<span class="source_string">"The green light on top of the weaponlockers indicates that additional ammo is available at that locker."</span>
<a name="1256"></a>     ONSHints(<span class="source_int">22</span>)=<span class="source_string">"Attack PowerNodes that have the enemy team color sky beams above them."</span>
<a name="1257"></a>     ONSHints(<span class="source_int">23</span>)=<span class="source_string">"You cannot attack the PowerCore or PowerNodes if there is an energy shield present. Remove the shield by controlling a node that is linked to it."</span>
<a name="1258"></a>     ONSHints(<span class="source_int">24</span>)=<span class="source_string">"The Grenade Launcher shoots sticky grenades that attach themselves to vehicles and players. You must detonate them yourself with the alternate fire (press %ALTFIRE%)"</span>
<a name="1259"></a>     ONSHints(<span class="source_int">25</span>)=<span class="source_string">"The bomber that the Target Painter calls in can be shot down by enemy fire."</span>
<a name="1260"></a>     ONSHints(<span class="source_int">26</span>)=<span class="source_string">"In Onslaught, your team earns 2 points for winning before overtime and 1 point for a win during overtime."</span>
<a name="1261"></a>     bScoreTeamKills=<span class="source_keyword">False</span>
<a name="1262"></a>     bSpawnInTeamArea=<span class="source_keyword">True</span>
<a name="1263"></a>     TeamAIType(<span class="source_int">0</span>)=<span class="source_keyword">Class</span><span class="source_name">'Onslaught.ONSTeamAI'</span>
<a name="1264"></a>     TeamAIType(<span class="source_int">1</span>)=<span class="source_keyword">Class</span><span class="source_name">'Onslaught.ONSTeamAI'</span>
<a name="1265"></a>     NetWait=<span class="source_int">15</span>
<a name="1266"></a>     bAlwaysShowLoginMenu=<span class="source_keyword">True</span>
<a name="1267"></a>     DefaultEnemyRosterClass=<span class="source_string">"XGame.xTeamRoster"</span>
<a name="1268"></a>     ADR_Kill=<span class="source_int">2.000000</span>
<a name="1269"></a>     LoginMenuClass=<span class="source_string">"GUI2K4.UT2K4OnslaughtLoginMenu"</span>
<a name="1270"></a>     bAllowVehicles=<span class="source_keyword">True</span>
<a name="1271"></a>     bLiberalVehiclePaths=<span class="source_keyword">True</span>
<a name="1272"></a>     GameUMenuType=<span class="source_string">"GUI2K4.UT2K4OnslaughtLoginMenu"</span>
<a name="1273"></a>     HUDSettingsMenu=<span class="source_string">"GUI2K4.CustomHUDMenuOnslaught"</span>
<a name="1274"></a>     HUDType=<span class="source_string">"Onslaught.ONSHUDOnslaught"</span>
<a name="1275"></a>     MapListType=<span class="source_string">"Onslaught.ONSMapListOnslaught"</span>
<a name="1276"></a>     <span class="source_type">MapPrefix</span>=<span class="source_string">"ONS"</span>
<a name="1277"></a>     BeaconName=<span class="source_string">"ONS"</span>
<a name="1278"></a>     ResetTimeDelay=<span class="source_int">11</span>
<a name="1279"></a>     GoalScore=<span class="source_int">3</span>
<a name="1280"></a>     <span class="source_type">MutatorClass</span>=<span class="source_string">"Onslaught.ONSDefaultMut"</span>
<a name="1281"></a>     GameName=<span class="source_string">"Onslaught"</span>
<a name="1282"></a>     Description=<span class="source_string">"Your team must take control over PowerNodes in a 'connect the dots' fashion to establish a direct line to the enemy PowerCore. Once you establish a link to the next PowerNode, you can destroy it if controlled by the enemy. Control the PowerNode for your team by touching it to start the build process (Use the linkgun alt-fire to speed things up). Once your team has a link to the enemy PowerCore, attack and destroy it."</span>
<a name="1283"></a>     ScreenShotName=<span class="source_string">"UT2004Thumbnails.OnslaughtShots"</span>
<a name="1284"></a>     DecoTextName=<span class="source_string">"Onslaught.ONSOnslaughtGame"</span>
<a name="1285"></a>     Acronym=<span class="source_string">"ONS"</span>
<a name="1286"></a>}
<a name="1287"></a></pre></td></tr></table></div>
<hr />
<table class="header">
<tr class="header">
	<td class="header"><a href="../overview.html">Overview</a></td>
	<td class="header"><a href="../onslaught/onslaught-overview.html">Package</a></td>
	<td class="header"><a href="../onslaught/onsonslaughtgame.html">Class</a></td>
	<td class="header_hilight">Source</td>
	<td class="header"><a class="header" href="../classtree.html#ONSOnslaughtGame">Class tree</a></td>
	<td class="header"><a class="header" href="../glossary_A.html">Glossary</a></td>
	<td class="logo" rowspan="2">UnrealScript<br />Documentation</td>
</tr>
<tr>
	<td class="subheader" colspan="3"><a href="../Source_onslaught/onsnodehealeffect.html">previous class</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../Source_onslaught/onsonslaughtmessage.html">next class</a></td>
	<td class="subheader" colspan="2"><a href="../index.html" target="_top">frames</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="" target="_top">no frames</a></td>
</tr>
</table>

<div class="stats">Class file time: Sun 31/3/2019 17:32:06.000 - Creation time: Mon 15/4/2019 10:25:11.725 - Created with <a href="http://wiki.beyondunreal.com/wiki/UnCodeX" target="_blank">UnCodeX</a></div>

</body>
</html>